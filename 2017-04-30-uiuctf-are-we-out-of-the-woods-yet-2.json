{"metadata":{"date":"Apr 30, 2017","title":"UIUCTF - Are we out of the woods yet? Reversing 350p","template":"post","slug":"uiuctf-are-we-out-of-the-woods-yet-2","categories":["CTF"],"tags":["CTF"]},"content":"<pre><code class=\"hljs language-apache\"><span class=\"hljs-attribute\">It</span> looks like this python script was run through a custom packer. It's just Python*, which means it must be easy to reverse, right?\n\n*<span class=\"hljs-attribute\">v3</span>.<span class=\"hljs-number\">6</span>.<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">69</span>c<span class=\"hljs-number\">0</span>db<span class=\"hljs-number\">5</span>\n\n<span class=\"hljs-attribute\">https</span>://www.youtube.com/watch?v=y<span class=\"hljs-number\">8</span>qQsXpcZXA\n</code></pre>\n<p>This was fun little challenge that our team (<a href=\"https://chalmersctf.se\">https://chalmersctf.se</a>) solved together. You are presented with the file <code>packed.py</code> that contains the following code:</p>\n<pre><code class=\"hljs language-apache\"><span class=\"hljs-attribute\">import</span> marshal, zlib, base<span class=\"hljs-number\">64</span>, itertools\n<span class=\"hljs-attribute\">def</span> xor_strings(_left, _k):\n    <span class=\"hljs-attribute\">out</span> = b''\n    <span class=\"hljs-attribute\">for</span> l, r in zip(_left, itertools.cycle(_k)):\n        <span class=\"hljs-attribute\">out</span> += (l ^ ord(r)).to_bytes(<span class=\"hljs-number\">1</span>, byteorder='big')\n    <span class=\"hljs-attribute\">return</span> out\n\n<span class=\"hljs-attribute\">def</span> YET_eval_code(p<span class=\"hljs-number\">1</span>, p<span class=\"hljs-number\">2</span>):\n    <span class=\"hljs-attribute\">YET_code</span> = marshal.loads(zlib.decompress(xor_strings(base<span class=\"hljs-number\">64</span>.b<span class=\"hljs-number\">64</span>decode(p<span class=\"hljs-number\">2</span>), p<span class=\"hljs-number\">1</span>)))\n    <span class=\"hljs-attribute\">eval</span>(YET_code)\n\n<span class=\"hljs-attribute\">YET_eval_code</span>(<span class=\"hljs-string\">\"YET\"</span>, b'IdkZDw<span class=\"hljs-number\">77</span>+o<span class=\"hljs-number\">1</span>N<span class=\"hljs-number\">7</span>Di<span class=\"hljs-number\">7</span>tKvNdbcGSyxAHBQCMDw<span class=\"hljs-number\">12</span>oRMcF<span class=\"hljs-number\">9</span>ROnVSwvKV+QF<span class=\"hljs-number\">5</span>+XW<span class=\"hljs-number\">7</span>ro<span class=\"hljs-number\">70</span>gu<span class=\"hljs-number\">6</span>ab<span class=\"hljs-number\">7</span>p<span class=\"hljs-number\">1</span>grlxNvbOLDMNXJpNfMagxOrwCrApxe<span class=\"hljs-number\">8</span>WxToZJ<span class=\"hljs-number\">7</span>Fo<span class=\"hljs-number\">1</span>LSzaO<span class=\"hljs-number\">87</span>HkVHachzv<span class=\"hljs-number\">7</span>ItMwuLq<span class=\"hljs-number\">4</span>nI<span class=\"hljs-number\">5</span>KBzqkyYmZaLf<span class=\"hljs-number\">6</span>NnIUN<span class=\"hljs-number\">7</span>OjslBoVvqbufNX+mk<span class=\"hljs-number\">6</span>G<span class=\"hljs-number\">33</span>qpKTDwzrwa<span class=\"hljs-number\">5</span>znSK<span class=\"hljs-number\">1</span>ARqs<span class=\"hljs-number\">3</span>rO<span class=\"hljs-number\">2</span>ayzgCgJFhtzrHHI<span class=\"hljs-number\">5</span>AvrFfqYL<span class=\"hljs-number\">9</span>brp<span class=\"hljs-number\">6</span>R<span class=\"hljs-number\">76</span>oobxtoLPuobrJa/qtJ<span class=\"hljs-number\">9</span>aEzLRviUqpozgaGn<span class=\"hljs-number\">9</span>b<span class=\"hljs-number\">3</span>hZzzJ<span class=\"hljs-number\">1</span>FgKoTprUzpjRKSqPUKKnqypcv<span class=\"hljs-number\">77</span>hOlQN<span class=\"hljs-number\">7</span>ylvLtgXbyp<span class=\"hljs-number\">8</span>uUikn+fu<span class=\"hljs-number\">6</span>+qu<span class=\"hljs-number\">7</span>EatZvLH<span class=\"hljs-number\">7</span>uq+ItqZKMCuvnDFvQv<span class=\"hljs-number\">9</span>KrnFpScbLApQ<span class=\"hljs-number\">5</span>rzvHpzvIqSm<span class=\"hljs-number\">7</span>qtk+WAhTd<span class=\"hljs-number\">2</span>TpkrK<span class=\"hljs-number\">46</span>eFhAJX+wDZCEBRlup/oqHNuPrwtPrQYKrCr<span class=\"hljs-number\">6</span>g<span class=\"hljs-number\">2</span>qdj<span class=\"hljs-number\">7</span>DpI+NvQij<span class=\"hljs-number\">9</span>CZ<span class=\"hljs-number\">5</span>CbrA<span class=\"hljs-number\">6</span>st+SiLLcxby<span class=\"hljs-number\">9</span>KLuQqpn/anzjP<span class=\"hljs-number\">1</span>e/ypYJbrrLdDBPqTJoLu<span class=\"hljs-number\">4</span>lWjLgt<span class=\"hljs-number\">0</span>Uavp<span class=\"hljs-number\">3</span>AkxGmdEvL+h/+JhpwCvOvFCLBOIDWU<span class=\"hljs-number\">5</span>Hrv<span class=\"hljs-number\">9</span>FArJXczYHFSNTsZR<span class=\"hljs-number\">2</span>wWp<span class=\"hljs-number\">7</span>G<span class=\"hljs-number\">0</span>h<span class=\"hljs-number\">7</span>EoVnor<span class=\"hljs-number\">9</span>bu<span class=\"hljs-number\">9</span>rpE<span class=\"hljs-number\">3</span>mF<span class=\"hljs-number\">6</span>rCRZp<span class=\"hljs-number\">5</span>gyutPGoP<span class=\"hljs-number\">4</span>mykp<span class=\"hljs-number\">7</span>As<span class=\"hljs-number\">1</span>p<span class=\"hljs-number\">3</span>fKWQ<span class=\"hljs-number\">2</span>COHQwB<span class=\"hljs-number\">1</span>cBrTy<span class=\"hljs-number\">93</span>iUvdvyoDiNYlHZ<span class=\"hljs-number\">2</span>Fgcr<span class=\"hljs-number\">8</span>zuRc<span class=\"hljs-number\">6</span>dKx<span class=\"hljs-number\">1</span>WtF<span class=\"hljs-number\">052</span>zhQuxMwo<span class=\"hljs-number\">1</span>eZ<span class=\"hljs-number\">61</span>u<span class=\"hljs-number\">0</span>k<span class=\"hljs-number\">9</span>XhOJPfBYeJ/QGU<span class=\"hljs-number\">3</span>yfiN<span class=\"hljs-number\">4</span>IHmgMOXznCRLgRmul<span class=\"hljs-number\">7</span>B+DYKLbXOHAHjYfvV+<span class=\"hljs-number\">7</span>RSQ<span class=\"hljs-number\">1</span>FrzxfFt/NWpaRTzKHvUltc<span class=\"hljs-number\">4</span>s<span class=\"hljs-number\">3</span>JiC<span class=\"hljs-number\">4</span>SvJpYQ<span class=\"hljs-number\">5</span>AiLrcF<span class=\"hljs-number\">079</span>BsC<span class=\"hljs-number\">4</span>ktOKZBrAU<span class=\"hljs-number\">5</span>Ys<span class=\"hljs-number\">7</span>n<span class=\"hljs-number\">2</span>kCYn<span class=\"hljs-number\">6</span>sbNd<span class=\"hljs-number\">5</span>uOlOMdEJXmL<span class=\"hljs-number\">6</span>t<span class=\"hljs-number\">0</span>UNpi<span class=\"hljs-number\">7</span>aXv<span class=\"hljs-number\">0</span>ntvswTVEyDCkgb<span class=\"hljs-number\">3</span>cUwDSxBREu<span class=\"hljs-number\">3</span>SKkQ+TSAaq<span class=\"hljs-number\">6</span>G<span class=\"hljs-number\">6</span>MRkHle<span class=\"hljs-number\">9</span>k<span class=\"hljs-number\">9</span>bJp<span class=\"hljs-number\">5</span>FwGMZBY<span class=\"hljs-number\">9</span>Gy<span class=\"hljs-number\">605</span>jyH<span class=\"hljs-number\">7</span>O<span class=\"hljs-number\">6</span>vKd<span class=\"hljs-number\">5</span>IkLX<span class=\"hljs-number\">82</span>SVQt<span class=\"hljs-number\">6</span>UVYmz<span class=\"hljs-number\">4</span>DHtTTP<span class=\"hljs-number\">5</span>wvWn<span class=\"hljs-number\">9</span>yf<span class=\"hljs-number\">7</span>HAb<span class=\"hljs-number\">8</span>X<span class=\"hljs-number\">5</span>pB<span class=\"hljs-number\">4</span>e<span class=\"hljs-number\">1</span>eoZQWjrsm<span class=\"hljs-number\">56</span>SjGvoGSGpqkei<span class=\"hljs-number\">8</span>yG<span class=\"hljs-number\">32</span>OecHjq<span class=\"hljs-number\">4</span>i<span class=\"hljs-number\">8</span>rBJu<span class=\"hljs-number\">5</span>hA<span class=\"hljs-number\">1</span>RgedxkKk<span class=\"hljs-number\">2</span>eNkhQnB<span class=\"hljs-number\">9</span>E<span class=\"hljs-number\">8</span>n<span class=\"hljs-number\">1</span>rE<span class=\"hljs-number\">631</span>x<span class=\"hljs-number\">8</span>sh+iY<span class=\"hljs-number\">7</span>YBfOvrGja<span class=\"hljs-number\">0</span>tPWHU<span class=\"hljs-number\">5</span>lQw<span class=\"hljs-number\">3</span>oBCsndS<span class=\"hljs-number\">4</span>fuHOgqeBGQz<span class=\"hljs-number\">3</span>xOIN<span class=\"hljs-number\">51</span>f<span class=\"hljs-number\">2</span>VG<span class=\"hljs-number\">9</span>N<span class=\"hljs-number\">6</span>in<span class=\"hljs-number\">8</span>xKP<span class=\"hljs-number\">3</span>iPxWBFPEZMi+LRYByR/PdMBDcm<span class=\"hljs-number\">2</span>xgLS<span class=\"hljs-number\">2</span>dAX<span class=\"hljs-number\">650</span>nh<span class=\"hljs-number\">3</span>uf/nwR<span class=\"hljs-number\">4</span>okZAn<span class=\"hljs-number\">5</span>Kesl<span class=\"hljs-number\">17</span>aJFtxRH/wIeiewc<span class=\"hljs-number\">5</span>v/ma<span class=\"hljs-number\">77</span>CKa<span class=\"hljs-number\">3</span>sdEKB<span class=\"hljs-number\">6</span>QYXT<span class=\"hljs-number\">8</span>V<span class=\"hljs-number\">6</span>DzlI<span class=\"hljs-number\">9</span>AVLCwlY<span class=\"hljs-number\">4</span>wbGrQJ<span class=\"hljs-number\">50</span>FwaXCexviMm+SvK/mar/wg<span class=\"hljs-number\">7</span>R<span class=\"hljs-number\">4</span>n<span class=\"hljs-number\">9</span>DJkqQG<span class=\"hljs-number\">9</span>ttSOiD<span class=\"hljs-number\">4</span>JNGxlciIU+<span class=\"hljs-number\">8</span>l<span class=\"hljs-number\">1</span>yFvSIwx<span class=\"hljs-number\">2</span>lZv<span class=\"hljs-number\">95</span>BGkoeUJWtNeHwDjsze/d<span class=\"hljs-number\">3</span>pLJL<span class=\"hljs-number\">5</span>WS<span class=\"hljs-number\">5</span>uxGeQxSaRf<span class=\"hljs-number\">33</span>/ZQ<span class=\"hljs-number\">3</span>hC<span class=\"hljs-number\">1</span>ImnSOj<span class=\"hljs-number\">7</span>CvgCzX+ONPZ<span class=\"hljs-number\">015</span>B/DbPO<span class=\"hljs-number\">4</span>If<span class=\"hljs-number\">9</span>B<span class=\"hljs-number\">0</span>KSAIXMnZRvNDN<span class=\"hljs-number\">3</span>Vj<span class=\"hljs-number\">6</span>rRTaZIpG<span class=\"hljs-number\">5</span>ILBqMAAYP//GSoFybXk<span class=\"hljs-number\">9</span>TF/OvD<span class=\"hljs-number\">0</span>SuN<span class=\"hljs-number\">6</span>TYpXyA<span class=\"hljs-number\">9</span>LrTF<span class=\"hljs-number\">5</span>RN<span class=\"hljs-number\">1</span>aezlNzGbT+d<span class=\"hljs-number\">2</span>uLRxdh<span class=\"hljs-number\">0</span>CRjRPnXACEAIU<span class=\"hljs-number\">8</span>oz<span class=\"hljs-number\">9</span>X<span class=\"hljs-number\">3</span>DT<span class=\"hljs-number\">8</span>emRPIaSi<span class=\"hljs-number\">7</span>UZ<span class=\"hljs-number\">2</span>LXiwUjT<span class=\"hljs-number\">7</span>MNIfIv<span class=\"hljs-number\">76</span>rNNAAjc<span class=\"hljs-number\">7</span>M<span class=\"hljs-number\">3</span>+<span class=\"hljs-number\">0</span>umCXiRBn<span class=\"hljs-number\">51</span>xRkFA+jAe<span class=\"hljs-number\">88</span>B<span class=\"hljs-number\">6</span>ZY<span class=\"hljs-number\">0</span>z/gpCyrNeV+<span class=\"hljs-number\">3</span>bAKkPLAR<span class=\"hljs-number\">0</span>bslOTfh<span class=\"hljs-number\">69</span>TwE<span class=\"hljs-number\">23</span>FONJ<span class=\"hljs-number\">9</span>uw<span class=\"hljs-number\">1</span>OSnE/lfcY<span class=\"hljs-number\">5</span>fJUL/l/<span class=\"hljs-number\">37</span>lfhB/fbtciyOhw<span class=\"hljs-number\">5</span>dQbM+<span class=\"hljs-number\">0</span>h<span class=\"hljs-number\">8</span>FgAjc<span class=\"hljs-number\">3</span>OkxrlIpyW<span class=\"hljs-number\">0</span>PYTa<span class=\"hljs-number\">0</span>VTJPzmgnCQxpKwCnFEUd<span class=\"hljs-number\">22</span>j<span class=\"hljs-number\">4</span>Wv/t<span class=\"hljs-number\">38</span>NeqsAVdNB<span class=\"hljs-number\">2</span>sVUlPFSn<span class=\"hljs-number\">4</span>/ls<span class=\"hljs-number\">9</span>EW<span class=\"hljs-number\">57</span>sddKVwZBIK<span class=\"hljs-number\">9</span>QX<span class=\"hljs-number\">577</span>WWHsM+<span class=\"hljs-number\">8</span>C<span class=\"hljs-number\">0</span>b<span class=\"hljs-number\">1</span>bN/ebkyTxaIAguZ/<span class=\"hljs-number\">35</span>b<span class=\"hljs-number\">0</span>Tzcbh/UNScwgDbXKtjLGvu<span class=\"hljs-number\">5</span>mKG<span class=\"hljs-number\">0</span>GBFfcg<span class=\"hljs-number\">3</span>NkDnmF<span class=\"hljs-number\">6</span>YCxztszEwX<span class=\"hljs-number\">72</span>DinUfpAk<span class=\"hljs-number\">3</span>AhnIpSJMMco//VTrg<span class=\"hljs-number\">2</span>JiuHNPrtdfYpNiadE<span class=\"hljs-number\">3</span>dvIBQTqu/VNId<span class=\"hljs-number\">0</span>uYEaxEEGnWl<span class=\"hljs-number\">6</span>LoBGKLPVK<span class=\"hljs-number\">6</span>NpUM<span class=\"hljs-number\">7</span>gwZzTHMCUiTAtyXXQ<span class=\"hljs-number\">2</span>OCAi<span class=\"hljs-number\">272</span>ZFfkhc<span class=\"hljs-number\">10</span>+YwkguyQb+VT+VjZqmCJKn<span class=\"hljs-number\">4</span>HT/bOG<span class=\"hljs-number\">4</span>XoM<span class=\"hljs-number\">5</span>ROd<span class=\"hljs-number\">36</span>u<span class=\"hljs-number\">5</span>cvdWE<span class=\"hljs-number\">7</span>goOyetdbcgfdqoZB<span class=\"hljs-number\">6</span>cwUvqSqdAMuvOA<span class=\"hljs-number\">6</span>z<span class=\"hljs-number\">7</span>vtrI<span class=\"hljs-number\">3</span>dbLBj<span class=\"hljs-number\">7</span>sbv<span class=\"hljs-number\">5</span>DlYe<span class=\"hljs-number\">2</span>omV<span class=\"hljs-number\">2</span>tGhTy++usTqOBL<span class=\"hljs-number\">9</span>PutSEI<span class=\"hljs-number\">6</span>ebG+MMtkfB<span class=\"hljs-number\">52</span>mDRb<span class=\"hljs-number\">0</span>QYkykqfkm<span class=\"hljs-number\">3</span>Fdy<span class=\"hljs-number\">6</span>ODbJ<span class=\"hljs-number\">96</span>wYknnY<span class=\"hljs-number\">0</span>Qr<span class=\"hljs-number\">52</span>e<span class=\"hljs-number\">5</span>clvtLHJ<span class=\"hljs-number\">4</span>aCzzHNK+d/c<span class=\"hljs-number\">4</span>i<span class=\"hljs-number\">0</span>NuLYtUTliEBdROV<span class=\"hljs-number\">535</span>dzoPAPcl<span class=\"hljs-number\">98</span>gN<span class=\"hljs-number\">0</span>DsWFBAFmAsNEkOUFRhvP<span class=\"hljs-number\">4</span>kk<span class=\"hljs-number\">3</span>FT<span class=\"hljs-number\">23</span>/MGakbnm<span class=\"hljs-number\">6</span>a<span class=\"hljs-number\">2</span>IN<span class=\"hljs-number\">7</span>G<span class=\"hljs-number\">6</span>vgsl<span class=\"hljs-number\">1</span>yaQb<span class=\"hljs-number\">9</span>BQfODdtnh<span class=\"hljs-number\">8</span>SYkyVHqhUfYdh<span class=\"hljs-number\">5</span>LuNV<span class=\"hljs-number\">3</span>qYT<span class=\"hljs-number\">7</span>O<span class=\"hljs-number\">2</span>WSo<span class=\"hljs-number\">33</span>y<span class=\"hljs-number\">8</span>n<span class=\"hljs-number\">3</span>XBhQ/gSGAe<span class=\"hljs-number\">7</span>ALRNhfD<span class=\"hljs-number\">3</span>HQtgVcH<span class=\"hljs-number\">2</span>WyoL/kmRi/WohIfjf<span class=\"hljs-number\">6</span>MA<span class=\"hljs-number\">2</span>jPHPQckasFxwKVc<span class=\"hljs-number\">5</span>rwS<span class=\"hljs-number\">6</span>/N<span class=\"hljs-number\">0</span>F<span class=\"hljs-number\">4</span>EJAAkFYDiODN/<span class=\"hljs-number\">29</span>r<span class=\"hljs-number\">5</span>uMQtnjtB/<span class=\"hljs-number\">6</span>gdZNT/Umjr<span class=\"hljs-number\">8</span>QkdRFgCKwX<span class=\"hljs-number\">2</span>mB/K<span class=\"hljs-number\">1</span>kf+<span class=\"hljs-number\">5</span>AZfIATOgZ<span class=\"hljs-number\">9</span>+gAd<span class=\"hljs-number\">0</span>/veeClPhYU<span class=\"hljs-number\">7</span>m<span class=\"hljs-number\">6</span>D<span class=\"hljs-number\">99</span>OS<span class=\"hljs-number\">7</span>zctg<span class=\"hljs-number\">4</span>NR<span class=\"hljs-number\">8</span>LCivwxjPI<span class=\"hljs-number\">4</span>UcfuTqf<span class=\"hljs-number\">3</span>i<span class=\"hljs-number\">2</span>Dk<span class=\"hljs-number\">5</span>ebw+Y<span class=\"hljs-number\">35</span>RKdwSkRgJxHMh<span class=\"hljs-number\">13</span>GeoPPuW<span class=\"hljs-number\">1</span>S<span class=\"hljs-number\">90</span>qYsyfGDg<span class=\"hljs-number\">6</span>KCgBt<span class=\"hljs-number\">6</span>qyP<span class=\"hljs-number\">60</span>lX/BbNOASutLMLxnQBZgNkISVfVsuz<span class=\"hljs-number\">2</span>vUlAWsq<span class=\"hljs-number\">0</span>E<span class=\"hljs-number\">4</span>ZEqd+JoOn<span class=\"hljs-number\">6</span>BkRQvpQ<span class=\"hljs-number\">9</span>Ltb<span class=\"hljs-number\">0</span>o<span class=\"hljs-number\">8</span>nEwj<span class=\"hljs-number\">0</span>jjEpyXMZ<span class=\"hljs-number\">56</span>RMXEay<span class=\"hljs-number\">0</span>IyG<span class=\"hljs-number\">5</span>WvJD<span class=\"hljs-number\">1309</span>fKdyTlidj<span class=\"hljs-number\">74</span>Hw/B<span class=\"hljs-number\">8</span>yEeK<span class=\"hljs-number\">3</span>CvPVCwsvsQlvIbeVxnqCN<span class=\"hljs-number\">1</span>SE<span class=\"hljs-number\">1</span>LDa<span class=\"hljs-number\">5</span>Q<span class=\"hljs-number\">2</span>dEO<span class=\"hljs-number\">0</span>H<span class=\"hljs-number\">9</span>CP<span class=\"hljs-number\">9</span>Brs<span class=\"hljs-number\">9</span>F<span class=\"hljs-number\">9</span>Afr<span class=\"hljs-number\">182</span>V<span class=\"hljs-number\">0</span>/XNkyghuLvPOEatSbo<span class=\"hljs-number\">86</span>KO<span class=\"hljs-number\">8</span>DI+flZ<span class=\"hljs-number\">80</span>gIBZ<span class=\"hljs-number\">09</span>DD<span class=\"hljs-number\">2</span>Ojxoy+Bz<span class=\"hljs-number\">73</span>L<span class=\"hljs-number\">8</span>UQV<span class=\"hljs-number\">3</span>mAUV<span class=\"hljs-number\">8</span>kbYuMA<span class=\"hljs-number\">02</span>J<span class=\"hljs-number\">34</span>BSFX<span class=\"hljs-number\">8</span>qhAhM+ACgjtT<span class=\"hljs-number\">7</span>JnFgt<span class=\"hljs-number\">3</span>x<span class=\"hljs-number\">9</span>Bz<span class=\"hljs-number\">0</span>h<span class=\"hljs-number\">0</span>SJZl<span class=\"hljs-number\">3</span>VxhrcK/Ynqw<span class=\"hljs-number\">1</span>pAEHE<span class=\"hljs-number\">2</span>exvnVRhX<span class=\"hljs-number\">9</span>tNTibRXhA/LZEc<span class=\"hljs-number\">0</span>xholsdG<span class=\"hljs-number\">73</span>ZG<span class=\"hljs-number\">4</span>xi<span class=\"hljs-number\">4</span>I<span class=\"hljs-number\">2</span>s<span class=\"hljs-number\">7</span>DnidKX<span class=\"hljs-number\">0</span>w<span class=\"hljs-number\">1</span>jLXPaXIuRP<span class=\"hljs-number\">5</span>esIV<span class=\"hljs-number\">2</span>ygPM<span class=\"hljs-number\">1</span>j<span class=\"hljs-number\">1</span>veSroeuovIaOpa<span class=\"hljs-number\">9</span>V<span class=\"hljs-number\">5</span>jyUokJoJZfPzrzForzrXL+k/mFXFKkqorXEjIbKpzuuuJjTvrpWCUQt<span class=\"hljs-number\">2</span>Q==')\n</code></pre>\n<p>We could quickly deduce that there was an embedded python program encoded with base64. In order to reveal the program we decompiled <code>YET_code</code> variable with <a href=\"https://docs.python.org/3/library/dis.html\" title=\"Disassembler for Python bytecode\">dis</a>.</p>\n<pre><code class=\"hljs language-stata\">import <span class=\"hljs-keyword\">dis</span>\n<span class=\"hljs-keyword\">print</span>(<span class=\"hljs-keyword\">dis</span>.disassemble(YET_code))\n</code></pre>\n<p>This revealed more embedded data:</p>\n<pre><code class=\"hljs language-apache\"><span class=\"hljs-attribute\">1</span>           <span class=\"hljs-number\">0</span> LOAD_CONST               <span class=\"hljs-number\">0</span> (<span class=\"hljs-number\">0</span>)\n            <span class=\"hljs-attribute\">2</span> LOAD_CONST               <span class=\"hljs-number\">1</span> (None)\n            <span class=\"hljs-attribute\">4</span> IMPORT_NAME              <span class=\"hljs-number\">0</span> (marshal)\n            <span class=\"hljs-attribute\">6</span> STORE_NAME               <span class=\"hljs-number\">0</span> (marshal)\n            <span class=\"hljs-attribute\">8</span> LOAD_CONST               <span class=\"hljs-number\">0</span> (<span class=\"hljs-number\">0</span>)\n           <span class=\"hljs-attribute\">10</span> LOAD_CONST               <span class=\"hljs-number\">1</span> (None)\n           <span class=\"hljs-attribute\">12</span> IMPORT_NAME              <span class=\"hljs-number\">1</span> (zlib)\n           <span class=\"hljs-attribute\">14</span> STORE_NAME               <span class=\"hljs-number\">1</span> (zlib)\n           <span class=\"hljs-attribute\">16</span> LOAD_CONST               <span class=\"hljs-number\">0</span> (<span class=\"hljs-number\">0</span>)\n           <span class=\"hljs-attribute\">18</span> LOAD_CONST               <span class=\"hljs-number\">1</span> (None)\n           <span class=\"hljs-attribute\">20</span> IMPORT_NAME              <span class=\"hljs-number\">2</span> (base<span class=\"hljs-number\">64</span>)\n           <span class=\"hljs-attribute\">22</span> STORE_NAME               <span class=\"hljs-number\">2</span> (base<span class=\"hljs-number\">64</span>)\n           <span class=\"hljs-attribute\">24</span> LOAD_CONST               <span class=\"hljs-number\">0</span> (<span class=\"hljs-number\">0</span>)\n           <span class=\"hljs-attribute\">26</span> LOAD_CONST               <span class=\"hljs-number\">1</span> (None)\n           <span class=\"hljs-attribute\">28</span> IMPORT_NAME              <span class=\"hljs-number\">3</span> (itertools)\n           <span class=\"hljs-attribute\">30</span> STORE_NAME               <span class=\"hljs-number\">3</span> (itertools)\n\n<span class=\"hljs-attribute\">2</span>          <span class=\"hljs-number\">32</span> LOAD_CONST               <span class=\"hljs-number\">2</span> (&#x3C;code object xor_strings at <span class=\"hljs-number\">0</span>x<span class=\"hljs-number\">10</span>f<span class=\"hljs-number\">9</span>fbf<span class=\"hljs-number\">60</span>, file <span class=\"hljs-string\">\"YETpacked\"</span>, line <span class=\"hljs-number\">2</span>>)\n           <span class=\"hljs-attribute\">34</span> LOAD_CONST               <span class=\"hljs-number\">3</span> ('xor_strings')\n           <span class=\"hljs-attribute\">36</span> MAKE_FUNCTION            <span class=\"hljs-number\">0</span>\n           <span class=\"hljs-attribute\">38</span> STORE_NAME               <span class=\"hljs-number\">4</span> (xor_strings)\n\n<span class=\"hljs-attribute\">8</span>          <span class=\"hljs-number\">40</span> LOAD_CONST               <span class=\"hljs-number\">4</span> (&#x3C;code object CLEAR_eval_code at <span class=\"hljs-number\">0</span>x<span class=\"hljs-number\">10</span>fa<span class=\"hljs-number\">38930</span>, file <span class=\"hljs-string\">\"YETpacked\"</span>, line <span class=\"hljs-number\">8</span>>)\n           <span class=\"hljs-attribute\">42</span> LOAD_CONST               <span class=\"hljs-number\">5</span> ('CLEAR_eval_code')\n           <span class=\"hljs-attribute\">44</span> MAKE_FUNCTION            <span class=\"hljs-number\">0</span>\n           <span class=\"hljs-attribute\">46</span> STORE_NAME               <span class=\"hljs-number\">5</span> (CLEAR_eval_code)\n\n<span class=\"hljs-attribute\">12</span>          <span class=\"hljs-number\">48</span> LOAD_NAME                <span class=\"hljs-number\">5</span> (CLEAR_eval_code)\n           <span class=\"hljs-attribute\">50</span> LOAD_CONST               <span class=\"hljs-number\">6</span> ('CLEAR')\n           <span class=\"hljs-attribute\">52</span> LOAD_CONST               <span class=\"hljs-number\">7</span> (b'O<span class=\"hljs-number\">9</span>AIFJnt<span class=\"hljs-number\">551</span>Qp<span class=\"hljs-number\">6</span>jQPnv/CwUCqBruZM<span class=\"hljs-number\">9</span>zmFJPhUdeEetQWjHdSilxStekT<span class=\"hljs-number\">7</span>JmRS<span class=\"hljs-number\">9</span>zWWJ<span class=\"hljs-number\">5</span>OzFyn<span class=\"hljs-number\">8</span>SoSrN/<span class=\"hljs-number\">3</span>SqRop<span class=\"hljs-number\">5</span>xRtkvd/<span class=\"hljs-number\">7</span>pH/T<span class=\"hljs-number\">3</span>Fhj<span class=\"hljs-number\">096</span>TttpKhdSiQnN<span class=\"hljs-number\">5</span>paPKugUk<span class=\"hljs-number\">7</span>jyEhraPLs<span class=\"hljs-number\">7</span>GPzKCU+k<span class=\"hljs-number\">2</span>YLyql<span class=\"hljs-number\">37</span>x<span class=\"hljs-number\">69</span>WaMhzevvcG<span class=\"hljs-number\">8</span>qHg<span class=\"hljs-number\">6</span>TX<span class=\"hljs-number\">3</span>Dw<span class=\"hljs-number\">1</span>z<span class=\"hljs-number\">9</span>ThIa/<span class=\"hljs-number\">71</span>whquplZ<span class=\"hljs-number\">8</span>D<span class=\"hljs-number\">2</span>HwlBbu<span class=\"hljs-number\">8</span>unCdvJbpc<span class=\"hljs-number\">4</span>mNnuFOhe/yoLWiq<span class=\"hljs-number\">5</span>QropRzuSSmKrAss<span class=\"hljs-number\">2</span>Q<span class=\"hljs-number\">5</span>V<span class=\"hljs-number\">9</span>Ki<span class=\"hljs-number\">5</span>YqrpCNCDLYfn<span class=\"hljs-number\">7</span>as<span class=\"hljs-number\">77</span>yhgWuzn<span class=\"hljs-number\">13</span>uzvZPDqD<span class=\"hljs-number\">8</span>t<span class=\"hljs-number\">4</span>GeXXg<span class=\"hljs-number\">0</span>yc<span class=\"hljs-number\">71</span>szm<span class=\"hljs-number\">9</span>ubA<span class=\"hljs-number\">7</span>Y<span class=\"hljs-number\">7</span>hNKn<span class=\"hljs-number\">00</span>ODvemJ+wsJfquATYNwq<span class=\"hljs-number\">9</span>PTO<span class=\"hljs-number\">9</span>La<span class=\"hljs-number\">56</span>h<span class=\"hljs-number\">0</span>+<span class=\"hljs-number\">8</span>NGzy<span class=\"hljs-number\">3</span>T<span class=\"hljs-number\">4</span>glIRvPgC<span class=\"hljs-number\">54</span>S<span class=\"hljs-number\">7</span>Pctt<span class=\"hljs-number\">6</span>vBVyw<span class=\"hljs-number\">4</span>gxS<span class=\"hljs-number\">7</span>J<span class=\"hljs-number\">0</span>Qe<span class=\"hljs-number\">2</span>rXrqmGRkuU/r<span class=\"hljs-number\">5</span>oNI<span class=\"hljs-number\">4</span>rqMm<span class=\"hljs-number\">38</span>TOF<span class=\"hljs-number\">0</span>oC<span class=\"hljs-number\">0</span>vG<span class=\"hljs-number\">6</span>xllqvE<span class=\"hljs-number\">1</span>Pa<span class=\"hljs-number\">4</span>Yu<span class=\"hljs-number\">1</span>PxXx+<span class=\"hljs-number\">7</span>ovrOxzy<span class=\"hljs-number\">2</span>XsOu<span class=\"hljs-number\">23</span>V<span class=\"hljs-number\">7</span>YxjkKza<span class=\"hljs-number\">40</span>eHvcrqIfvZistukBntEGuLPulzBmZas<span class=\"hljs-number\">4</span>SKSF<span class=\"hljs-number\">1</span>IvClVMGqGHO<span class=\"hljs-number\">9</span>Wc/+aNjKt+WsKNwgzLypkmw<span class=\"hljs-number\">5</span>zn<span class=\"hljs-number\">9</span>tTR<span class=\"hljs-number\">7</span>e<span class=\"hljs-number\">9</span>cMLNgvUKh<span class=\"hljs-number\">1</span>ij<span class=\"hljs-number\">4</span>ev<span class=\"hljs-number\">4</span>YMH<span class=\"hljs-number\">5</span>W<span class=\"hljs-number\">1</span>pM<span class=\"hljs-number\">83</span>ZPYTMc+rm<span class=\"hljs-number\">3</span>+qOyzDE<span class=\"hljs-number\">7</span>OerP<span class=\"hljs-number\">9</span>rv<span class=\"hljs-number\">6</span>El<span class=\"hljs-number\">9</span>RsXDYymsDNJ<span class=\"hljs-number\">7</span>KrweK<span class=\"hljs-number\">9</span>QyTMzY<span class=\"hljs-number\">3</span>Y<span class=\"hljs-number\">6</span>h<span class=\"hljs-number\">5</span>JKZ<span class=\"hljs-number\">8</span>RvOTYUkRbmPC<span class=\"hljs-number\">0</span>u<span class=\"hljs-number\">9</span>ADKvVmaa<span class=\"hljs-number\">7</span>d++QYjC+T<span class=\"hljs-number\">6</span>mT<span class=\"hljs-number\">4</span>n<span class=\"hljs-number\">7</span>bBe<span class=\"hljs-number\">6</span>vO<span class=\"hljs-number\">2</span>VWFn<span class=\"hljs-number\">4</span>A+KJPuiUTNdnVrWOp<span class=\"hljs-number\">4</span>bJGtWYvQiMt<span class=\"hljs-number\">2</span>JJkqxEkn+bEJAIFSagqlkzvbHqEgroQ<span class=\"hljs-number\">7</span>IfFLRlggaPgD<span class=\"hljs-number\">2</span>HwhOnSLe<span class=\"hljs-number\">3</span>iWv<span class=\"hljs-number\">5</span>dmN<span class=\"hljs-number\">2</span>RSw<span class=\"hljs-number\">3</span>Y<span class=\"hljs-number\">3</span>/FmHtqSggdkTFIWn<span class=\"hljs-number\">6</span>QIHw<span class=\"hljs-number\">1</span>AhR<span class=\"hljs-number\">5</span>RkcAEHtMX<span class=\"hljs-number\">3</span>OgX<span class=\"hljs-number\">57</span>TvVbOSOWJdHVW<span class=\"hljs-number\">681</span>jljW<span class=\"hljs-number\">4</span>jJigjBMDdP<span class=\"hljs-number\">1</span>fIp/PGVVXXvxf<span class=\"hljs-number\">6</span>WvCPvCGZVWdNl<span class=\"hljs-number\">0</span>HHFsukzvE<span class=\"hljs-number\">1</span>Rs<span class=\"hljs-number\">5</span>atOjgTBVaMO<span class=\"hljs-number\">3</span>xfbNWrH<span class=\"hljs-number\">7</span>kU<span class=\"hljs-number\">1</span>pKYNma<span class=\"hljs-number\">7</span>yFWaKNmBQxikPs<span class=\"hljs-number\">5</span>qoG+mpuYWNSlDiEagihc<span class=\"hljs-number\">7</span>sU<span class=\"hljs-number\">9</span>hS+g<span class=\"hljs-number\">31</span>WJpeQVVGgnA<span class=\"hljs-number\">22</span>gtaE<span class=\"hljs-number\">3</span>EoxOlOovJGXWzQEbOUKdU<span class=\"hljs-number\">2</span>w<span class=\"hljs-number\">8</span>eJrpdsQy<span class=\"hljs-number\">4</span>f<span class=\"hljs-number\">5</span>p<span class=\"hljs-number\">8</span>i<span class=\"hljs-number\">1</span>QObO<span class=\"hljs-number\">6</span>iFufjYT<span class=\"hljs-number\">2</span>NqYE<span class=\"hljs-number\">0</span>Sqiw<span class=\"hljs-number\">4</span>P<span class=\"hljs-number\">3</span>aA+trXcvO<span class=\"hljs-number\">1</span>GBOZd<span class=\"hljs-number\">9</span>R<span class=\"hljs-number\">5</span>neccwHbpqVioWFsAwnY<span class=\"hljs-number\">4</span>FVFEl<span class=\"hljs-number\">8</span>mKHU+Evy<span class=\"hljs-number\">53</span>HKV<span class=\"hljs-number\">1</span>v<span class=\"hljs-number\">1</span>eMgz<span class=\"hljs-number\">8</span>/AmQLS<span class=\"hljs-number\">9</span>yNyDQghTRAIqnWQOAtbY<span class=\"hljs-number\">7</span>ePMF<span class=\"hljs-number\">2</span>aKpXyNHrdF<span class=\"hljs-number\">6</span>dbxgAhrOr<span class=\"hljs-number\">6</span>Ef<span class=\"hljs-number\">9</span>UYFU<span class=\"hljs-number\">1</span>CFf<span class=\"hljs-number\">82</span>/y/GUvnBy<span class=\"hljs-number\">8</span>X<span class=\"hljs-number\">0</span>oGyb<span class=\"hljs-number\">7</span>m<span class=\"hljs-number\">3</span>QZwR/tk+su<span class=\"hljs-number\">2</span>bAYA<span class=\"hljs-number\">2</span>mbncm<span class=\"hljs-number\">1</span>SPolrDq<span class=\"hljs-number\">04</span>cGiSUNgQ<span class=\"hljs-number\">7</span>kVlHGjqs<span class=\"hljs-number\">421</span>f<span class=\"hljs-number\">0</span>IQ<span class=\"hljs-number\">74</span>H<span class=\"hljs-number\">2</span>QnaWsAvLA<span class=\"hljs-number\">2</span>RuPdiFCjBwTABiFzdVLYUXnGKDZRPotE<span class=\"hljs-number\">4</span>d+sv<span class=\"hljs-number\">5</span>t<span class=\"hljs-number\">2</span>rwFU<span class=\"hljs-number\">6</span>lAz<span class=\"hljs-number\">7</span>iV+MsobMP<span class=\"hljs-number\">4</span>bRWzhsDkqdvIhxmURlyzBFpxyyLgRN<span class=\"hljs-number\">1</span>wwySWhxyTmEV<span class=\"hljs-number\">1</span>Zzg<span class=\"hljs-number\">1</span>S<span class=\"hljs-number\">6</span>B<span class=\"hljs-number\">1</span>utLIFx<span class=\"hljs-number\">7</span>fQyHfYCFRSfkqJflpQgjvNEuq<span class=\"hljs-number\">572</span>Jo<span class=\"hljs-number\">0</span>qI<span class=\"hljs-number\">37</span>VQ<span class=\"hljs-number\">1</span>Q+f<span class=\"hljs-number\">65</span>v/HogcPkZ<span class=\"hljs-number\">4</span>G<span class=\"hljs-number\">73</span>ZXwnYcywPBN+sV<span class=\"hljs-number\">8</span>eJTmPDk<span class=\"hljs-number\">0</span>s<span class=\"hljs-number\">9</span>++jdhJmmnSd<span class=\"hljs-number\">78</span>YjxZNaZk<span class=\"hljs-number\">4</span>WJZFpai<span class=\"hljs-number\">9</span>Y<span class=\"hljs-number\">1</span>qENEm<span class=\"hljs-number\">9</span>tYzVr<span class=\"hljs-number\">1</span>AtEhe<span class=\"hljs-number\">2</span>nHuIAEIZdPyMLf<span class=\"hljs-number\">9</span>KduhqjKMDwHHiZjQr<span class=\"hljs-number\">01</span>VQrUoNc<span class=\"hljs-number\">1</span>ZsYJmZItQ<span class=\"hljs-number\">9</span>Fo<span class=\"hljs-number\">0</span>DZY<span class=\"hljs-number\">2</span>jSag/sjMdpkrClk/FqiMzQVJarQWJTZQ<span class=\"hljs-number\">28</span>pYwYES<span class=\"hljs-number\">94</span>NCLfeK<span class=\"hljs-number\">4</span>b<span class=\"hljs-number\">1</span>W<span class=\"hljs-number\">0</span>W<span class=\"hljs-number\">26</span>Dl<span class=\"hljs-number\">7</span>/SatFemYHWEWo<span class=\"hljs-number\">1</span>OKQFZyipgn<span class=\"hljs-number\">7</span>YseI<span class=\"hljs-number\">57</span>/iHKrofwzxWbGYGYKgBwvKqGCo<span class=\"hljs-number\">7</span>iJRwvhAjKCkCyoC<span class=\"hljs-number\">8</span>d<span class=\"hljs-number\">0</span>T<span class=\"hljs-number\">0</span>PcHZJSqNK<span class=\"hljs-number\">0</span>TSVvmfvQr/qbqCQ<span class=\"hljs-number\">3</span>Fhq<span class=\"hljs-number\">1</span>xfKv<span class=\"hljs-number\">30</span>YBseNFb<span class=\"hljs-number\">9</span>OQvgGZMWZRaY<span class=\"hljs-number\">4</span>ENy<span class=\"hljs-number\">79</span>ltbdRfu<span class=\"hljs-number\">1</span>RfZcDSdKoVARwtsM<span class=\"hljs-number\">8</span>tp<span class=\"hljs-number\">4</span>uSUx<span class=\"hljs-number\">3</span>fdP<span class=\"hljs-number\">4</span>yqLwwyFgvbUvcBXXR<span class=\"hljs-number\">8</span>+WP<span class=\"hljs-number\">1</span>JSXGVd<span class=\"hljs-number\">0</span>BN<span class=\"hljs-number\">6</span>w<span class=\"hljs-number\">7</span>nAXTjJpC/AQA<span class=\"hljs-number\">9</span>WnSSpH<span class=\"hljs-number\">1</span>ldgAKrYYO<span class=\"hljs-number\">9</span>tJDhJWWfd<span class=\"hljs-number\">12</span>pkMDxQ<span class=\"hljs-number\">1</span>tU<span class=\"hljs-number\">4</span>C<span class=\"hljs-number\">8</span>lDfWIZE<span class=\"hljs-number\">2</span>dBda<span class=\"hljs-number\">3</span>zjEWdfLJbIKGOL<span class=\"hljs-number\">9</span>CamP<span class=\"hljs-number\">8</span>pPcQbWyMnov<span class=\"hljs-number\">5</span>AndNe<span class=\"hljs-number\">1</span>x<span class=\"hljs-number\">88</span>CYgUzHeRI<span class=\"hljs-number\">3</span>FieNuSHu<span class=\"hljs-number\">1</span>n/XrmVlVlddxErBBhqevTiqM<span class=\"hljs-number\">2</span>LOdl<span class=\"hljs-number\">7</span>vO<span class=\"hljs-number\">9</span>FJvyWDpbOyHkhJh/yaJOpAEg<span class=\"hljs-number\">85</span>VzKlqbnsqgVBh<span class=\"hljs-number\">0</span>ojZt<span class=\"hljs-number\">6</span>OtIAY<span class=\"hljs-number\">74</span>//d<span class=\"hljs-number\">1</span>ippt<span class=\"hljs-number\">0</span>YQPpxMskdOEUfTctStTvyD<span class=\"hljs-number\">1</span>vKLK<span class=\"hljs-number\">8</span>ZrbVadtDdWhIYihpXAr<span class=\"hljs-number\">8</span>DcpkTMaAdQdZWcAL<span class=\"hljs-number\">5</span>YzNHdOE<span class=\"hljs-number\">7</span>qg<span class=\"hljs-number\">1</span>s<span class=\"hljs-number\">65</span>fLJCPwl+oir<span class=\"hljs-number\">2</span>boC<span class=\"hljs-number\">1</span>xXbt+RB<span class=\"hljs-number\">3</span>yCHK<span class=\"hljs-number\">91</span>bSatCH<span class=\"hljs-number\">2</span>pAK<span class=\"hljs-number\">3</span>vcRjim<span class=\"hljs-number\">7</span>BvE<span class=\"hljs-number\">6</span>k<span class=\"hljs-number\">5</span>CIy')\n           <span class=\"hljs-attribute\">54</span> CALL_FUNCTION            <span class=\"hljs-number\">2</span>\n           <span class=\"hljs-attribute\">56</span> POP_TOP\n           <span class=\"hljs-attribute\">58</span> LOAD_CONST               <span class=\"hljs-number\">1</span> (None)\n           <span class=\"hljs-attribute\">60</span> RETURN_VALUE\n<span class=\"hljs-attribute\">None</span>\n</code></pre>\n<p>By substituting the <code>YET_eval_code</code> function call with the key <code>CLEAR</code> and with the above base64 encoded data, we get an other embedded python program. This process continues 3 more times until we reach the last and final program. This is how it looks like disassembled:</p>\n<pre><code class=\"hljs language-basic\"><span class=\"hljs-symbol\">1 </span>          <span class=\"hljs-number\">0</span> LOAD_CONST               <span class=\"hljs-number\">0</span> (<span class=\"hljs-number\">1338</span>)\n            <span class=\"hljs-number\">2</span> STORE_NAME               <span class=\"hljs-number\">0</span> (x0)\n\n<span class=\"hljs-symbol\">2 </span>          <span class=\"hljs-number\">4</span> LOAD_CONST               <span class=\"hljs-number\">1</span> (<span class=\"hljs-number\">413</span>)\n            <span class=\"hljs-number\">6</span> STORE_NAME               <span class=\"hljs-number\">1</span> (x1)\n\n<span class=\"hljs-symbol\">3 </span>          <span class=\"hljs-number\">8</span> LOAD_CONST               <span class=\"hljs-number\">2</span> (<span class=\"hljs-number\">3.5699</span>)\n           <span class=\"hljs-number\">10</span> STORE_NAME               <span class=\"hljs-number\">2</span> (r)\n\n<span class=\"hljs-symbol\">4 </span>         <span class=\"hljs-number\">12</span> LOAD_NAME                <span class=\"hljs-number\">0</span> (x0)\n           <span class=\"hljs-number\">14</span> STORE_NAME               <span class=\"hljs-number\">3</span> (xn)\n\n<span class=\"hljs-symbol\">5 </span>         <span class=\"hljs-number\">16</span> LOAD_NAME                <span class=\"hljs-number\">1</span> (x1)\n           <span class=\"hljs-number\">18</span> STORE_NAME               <span class=\"hljs-number\">4</span> (xk)\n\n<span class=\"hljs-symbol\">7 </span>         <span class=\"hljs-number\">20</span> LOAD_CONST               <span class=\"hljs-number\">3</span> (<span class=\"hljs-comment\">'')</span>\n           <span class=\"hljs-number\">22</span> STORE_NAME               <span class=\"hljs-number\">5</span> (accumulated)\n\n<span class=\"hljs-symbol\">9 </span>         <span class=\"hljs-number\">24</span> LOAD_NAME                <span class=\"hljs-number\">6</span> (<span class=\"hljs-keyword\">input</span>)\n           <span class=\"hljs-number\">26</span> LOAD_CONST               <span class=\"hljs-number\">4</span> (<span class=\"hljs-comment\">'I N P U T: ')</span>\n           <span class=\"hljs-number\">28</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n           <span class=\"hljs-number\">30</span> STORE_NAME               <span class=\"hljs-number\">7</span> (user)\n\n<span class=\"hljs-symbol\">10 </span>         <span class=\"hljs-number\">32</span> SETUP_EXCEPT            <span class=\"hljs-number\">14</span> (<span class=\"hljs-keyword\">to</span> <span class=\"hljs-number\">48</span>)\n\n<span class=\"hljs-symbol\">11 </span>         <span class=\"hljs-number\">34</span> LOAD_NAME                <span class=\"hljs-number\">8</span> (bytes)\n           <span class=\"hljs-number\">36</span> LOAD_ATTR                <span class=\"hljs-number\">9</span> (fromhex)\n           <span class=\"hljs-number\">38</span> LOAD_NAME                <span class=\"hljs-number\">7</span> (user)\n           <span class=\"hljs-number\">40</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n           <span class=\"hljs-number\">42</span> STORE_NAME               <span class=\"hljs-number\">7</span> (user)\n           <span class=\"hljs-number\">44</span> POP_BLOCK\n           <span class=\"hljs-number\">46</span> JUMP_FORWARD            <span class=\"hljs-number\">36</span> (<span class=\"hljs-keyword\">to</span> <span class=\"hljs-number\">84</span>)\n\n<span class=\"hljs-symbol\">12 </span>    >>   <span class=\"hljs-number\">48</span> DUP_TOP\n           <span class=\"hljs-number\">50</span> LOAD_NAME               <span class=\"hljs-number\">10</span> (ValueError)\n           <span class=\"hljs-number\">52</span> COMPARE_OP              <span class=\"hljs-number\">10</span> (exception match)\n           <span class=\"hljs-number\">54</span> POP_JUMP_IF_FALSE       <span class=\"hljs-number\">82</span>\n           <span class=\"hljs-number\">56</span> POP_TOP\n           <span class=\"hljs-number\">58</span> POP_TOP\n           <span class=\"hljs-number\">60</span> POP_TOP\n\n<span class=\"hljs-symbol\">13 </span>         <span class=\"hljs-number\">62</span> LOAD_NAME               <span class=\"hljs-number\">11</span> (<span class=\"hljs-keyword\">print</span>)\n           <span class=\"hljs-number\">64</span> LOAD_CONST               <span class=\"hljs-number\">5</span> (<span class=\"hljs-comment\">'Non-hex byte entered!')</span>\n           <span class=\"hljs-number\">66</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n           <span class=\"hljs-number\">68</span> POP_TOP\n\n<span class=\"hljs-symbol\">14 </span>         <span class=\"hljs-number\">70</span> LOAD_NAME               <span class=\"hljs-number\">12</span> (exit)\n           <span class=\"hljs-number\">72</span> LOAD_CONST              <span class=\"hljs-number\">14</span> (-<span class=\"hljs-number\">1</span>)\n           <span class=\"hljs-number\">74</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n           <span class=\"hljs-number\">76</span> POP_TOP\n           <span class=\"hljs-number\">78</span> POP_EXCEPT\n           <span class=\"hljs-number\">80</span> JUMP_FORWARD             <span class=\"hljs-number\">2</span> (<span class=\"hljs-keyword\">to</span> <span class=\"hljs-number\">84</span>)\n      >>   <span class=\"hljs-number\">82</span> END_FINALLY\n\n<span class=\"hljs-symbol\">15 </span>    >>   <span class=\"hljs-number\">84</span> LOAD_CONST               <span class=\"hljs-number\">7</span> (b<span class=\"hljs-comment\">'\\x8b*&#x3C;LH~\\xdc\\xc4\\xfc\\xad\\xff9\\xe8h\\x8d^\\xf2\\xc3\\xa7\\xc9&#x26;\\x8f \\xeaE_\\xb0T\\x05\\xe5\\xff\\x9cD\\x9e\\x84\\x13k\\x0f~\\xb5\\x9cUm\\x08\\\\')</span>\n           <span class=\"hljs-number\">86</span> STORE_NAME              <span class=\"hljs-number\">13</span> (flag)\n\n<span class=\"hljs-symbol\">16 </span>         <span class=\"hljs-number\">88</span> SETUP_LOOP             <span class=\"hljs-number\">152</span> (<span class=\"hljs-keyword\">to</span> <span class=\"hljs-number\">242</span>)\n           <span class=\"hljs-number\">90</span> LOAD_NAME               <span class=\"hljs-number\">14</span> (zip)\n           <span class=\"hljs-number\">92</span> LOAD_NAME               <span class=\"hljs-number\">13</span> (flag)\n           <span class=\"hljs-number\">94</span> LOAD_NAME                <span class=\"hljs-number\">7</span> (user)\n           <span class=\"hljs-number\">96</span> CALL_FUNCTION            <span class=\"hljs-number\">2</span>\n           <span class=\"hljs-number\">98</span> GET_ITER\n      >>  <span class=\"hljs-number\">100</span> FOR_ITER               <span class=\"hljs-number\">138</span> (<span class=\"hljs-keyword\">to</span> <span class=\"hljs-number\">240</span>)\n          <span class=\"hljs-number\">102</span> UNPACK_SEQUENCE          <span class=\"hljs-number\">2</span>\n          <span class=\"hljs-number\">104</span> STORE_NAME              <span class=\"hljs-number\">15</span> (flagchar)\n          <span class=\"hljs-number\">106</span> STORE_NAME              <span class=\"hljs-number\">16</span> (userchar)\n\n<span class=\"hljs-symbol\">17 </span>        <span class=\"hljs-number\">108</span> LOAD_NAME                <span class=\"hljs-number\">2</span> (r)\n          <span class=\"hljs-number\">110</span> LOAD_NAME                <span class=\"hljs-number\">3</span> (xn)\n          <span class=\"hljs-number\">112</span> BINARY_MULTIPLY\n          <span class=\"hljs-number\">114</span> LOAD_CONST               <span class=\"hljs-number\">6</span> (<span class=\"hljs-number\">1</span>)\n          <span class=\"hljs-number\">116</span> LOAD_NAME                <span class=\"hljs-number\">3</span> (xn)\n          <span class=\"hljs-number\">118</span> BINARY_SUBTRACT\n          <span class=\"hljs-number\">120</span> BINARY_MULTIPLY\n          <span class=\"hljs-number\">122</span> LOAD_NAME                <span class=\"hljs-number\">0</span> (x0)\n          <span class=\"hljs-number\">124</span> BINARY_MODULO\n          <span class=\"hljs-number\">126</span> STORE_NAME               <span class=\"hljs-number\">3</span> (xn)\n\n<span class=\"hljs-symbol\">18 </span>        <span class=\"hljs-number\">128</span> LOAD_NAME               <span class=\"hljs-number\">17</span> (<span class=\"hljs-keyword\">int</span>)\n          <span class=\"hljs-number\">130</span> LOAD_NAME                <span class=\"hljs-number\">3</span> (xn)\n          <span class=\"hljs-number\">132</span> LOAD_CONST              <span class=\"hljs-number\">15</span> (<span class=\"hljs-number\">100</span>)\n          <span class=\"hljs-number\">134</span> BINARY_MULTIPLY\n          <span class=\"hljs-number\">136</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n          <span class=\"hljs-number\">138</span> LOAD_CONST              <span class=\"hljs-number\">10</span> (<span class=\"hljs-number\">255</span>)\n          <span class=\"hljs-number\">140</span> BINARY_MODULO\n          <span class=\"hljs-number\">142</span> STORE_NAME               <span class=\"hljs-number\">3</span> (xn)\n\n<span class=\"hljs-symbol\">20 </span>        <span class=\"hljs-number\">144</span> LOAD_NAME                <span class=\"hljs-number\">2</span> (r)\n          <span class=\"hljs-number\">146</span> LOAD_NAME                <span class=\"hljs-number\">4</span> (xk)\n          <span class=\"hljs-number\">148</span> BINARY_MULTIPLY\n          <span class=\"hljs-number\">150</span> LOAD_CONST               <span class=\"hljs-number\">6</span> (<span class=\"hljs-number\">1</span>)\n          <span class=\"hljs-number\">152</span> LOAD_NAME                <span class=\"hljs-number\">4</span> (xk)\n          <span class=\"hljs-number\">154</span> BINARY_SUBTRACT\n          <span class=\"hljs-number\">156</span> BINARY_MULTIPLY\n          <span class=\"hljs-number\">158</span> LOAD_NAME                <span class=\"hljs-number\">1</span> (x1)\n          <span class=\"hljs-number\">160</span> BINARY_MODULO\n          <span class=\"hljs-number\">162</span> STORE_NAME               <span class=\"hljs-number\">4</span> (xk)\n\n<span class=\"hljs-symbol\">21 </span>        <span class=\"hljs-number\">164</span> LOAD_NAME               <span class=\"hljs-number\">17</span> (<span class=\"hljs-keyword\">int</span>)\n          <span class=\"hljs-number\">166</span> LOAD_NAME                <span class=\"hljs-number\">4</span> (xk)\n          <span class=\"hljs-number\">168</span> LOAD_CONST              <span class=\"hljs-number\">16</span> (<span class=\"hljs-number\">100</span>)\n          <span class=\"hljs-number\">170</span> BINARY_MULTIPLY\n          <span class=\"hljs-number\">172</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n          <span class=\"hljs-number\">174</span> LOAD_CONST              <span class=\"hljs-number\">10</span> (<span class=\"hljs-number\">255</span>)\n          <span class=\"hljs-number\">176</span> BINARY_MODULO\n          <span class=\"hljs-number\">178</span> STORE_NAME               <span class=\"hljs-number\">4</span> (xk)\n\n<span class=\"hljs-symbol\">23 </span>        <span class=\"hljs-number\">180</span> LOAD_NAME               <span class=\"hljs-number\">18</span> (chr)\n          <span class=\"hljs-number\">182</span> LOAD_NAME                <span class=\"hljs-number\">3</span> (xn)\n          <span class=\"hljs-number\">184</span> LOAD_NAME               <span class=\"hljs-number\">15</span> (flagchar)\n          <span class=\"hljs-number\">186</span> BINARY_XOR\n          <span class=\"hljs-number\">188</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n          <span class=\"hljs-number\">190</span> STORE_NAME              <span class=\"hljs-number\">19</span> (flagbyte)\n\n<span class=\"hljs-symbol\">24 </span>        <span class=\"hljs-number\">192</span> LOAD_NAME               <span class=\"hljs-number\">18</span> (chr)\n          <span class=\"hljs-number\">194</span> LOAD_NAME                <span class=\"hljs-number\">4</span> (xk)\n          <span class=\"hljs-number\">196</span> LOAD_NAME               <span class=\"hljs-number\">16</span> (userchar)\n          <span class=\"hljs-number\">198</span> BINARY_XOR\n          <span class=\"hljs-number\">200</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n          <span class=\"hljs-number\">202</span> STORE_NAME              <span class=\"hljs-number\">20</span> (userbyte)\n\n<span class=\"hljs-symbol\">26 </span>        <span class=\"hljs-number\">204</span> LOAD_NAME               <span class=\"hljs-number\">19</span> (flagbyte)\n          <span class=\"hljs-number\">206</span> LOAD_NAME               <span class=\"hljs-number\">20</span> (userbyte)\n          <span class=\"hljs-number\">208</span> COMPARE_OP               <span class=\"hljs-number\">3</span> (!=)\n          <span class=\"hljs-number\">210</span> POP_JUMP_IF_FALSE      <span class=\"hljs-number\">230</span>\n\n<span class=\"hljs-symbol\">27 </span>        <span class=\"hljs-number\">212</span> LOAD_NAME               <span class=\"hljs-number\">11</span> (<span class=\"hljs-keyword\">print</span>)\n          <span class=\"hljs-number\">214</span> LOAD_CONST              <span class=\"hljs-number\">11</span> (<span class=\"hljs-comment\">'Still in the woods')</span>\n          <span class=\"hljs-number\">216</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n          <span class=\"hljs-number\">218</span> POP_TOP\n\n<span class=\"hljs-symbol\">28 </span>        <span class=\"hljs-number\">220</span> LOAD_NAME               <span class=\"hljs-number\">12</span> (exit)\n          <span class=\"hljs-number\">222</span> LOAD_CONST              <span class=\"hljs-number\">17</span> (-<span class=\"hljs-number\">1</span>)\n          <span class=\"hljs-number\">224</span> CALL_FUNCTION            <span class=\"hljs-number\">1</span>\n          <span class=\"hljs-number\">226</span> POP_TOP\n          <span class=\"hljs-number\">228</span> JUMP_ABSOLUTE          <span class=\"hljs-number\">100</span>\n\n<span class=\"hljs-symbol\">30 </span>    >>  <span class=\"hljs-number\">230</span> LOAD_NAME                <span class=\"hljs-number\">5</span> (accumulated)\n          <span class=\"hljs-number\">232</span> LOAD_NAME               <span class=\"hljs-number\">20</span> (userbyte)\n          <span class=\"hljs-number\">234</span> INPLACE_ADD\n          <span class=\"hljs-number\">236</span> STORE_NAME               <span class=\"hljs-number\">5</span> (accumulated)\n          <span class=\"hljs-number\">238</span> JUMP_ABSOLUTE          <span class=\"hljs-number\">100</span>\n      >>  <span class=\"hljs-number\">240</span> POP_BLOCK\n\n<span class=\"hljs-symbol\">32 </span>    >>  <span class=\"hljs-number\">242</span> LOAD_NAME               <span class=\"hljs-number\">11</span> (<span class=\"hljs-keyword\">print</span>)\n          <span class=\"hljs-number\">244</span> LOAD_CONST              <span class=\"hljs-number\">12</span> (<span class=\"hljs-comment\">'Looking at it now, it all seems so simple:')</span>\n          <span class=\"hljs-number\">246</span> LOAD_NAME                <span class=\"hljs-number\">5</span> (accumulated)\n          <span class=\"hljs-number\">248</span> CALL_FUNCTION            <span class=\"hljs-number\">2</span>\n          <span class=\"hljs-number\">250</span> POP_TOP\n          <span class=\"hljs-number\">252</span> LOAD_CONST              <span class=\"hljs-number\">13</span> (None)\n          <span class=\"hljs-number\">254</span> RETURN_VALUE\nNone\n</code></pre>\n<p>We managed to reverse engineer the above output into the following python source:</p>\n<pre><code class=\"hljs language-apache\"><span class=\"hljs-attribute\">import</span> sys\n\n<span class=\"hljs-attribute\">x0</span> = <span class=\"hljs-number\">1338</span>\n<span class=\"hljs-attribute\">x1</span> = <span class=\"hljs-number\">413</span>\n<span class=\"hljs-attribute\">r</span> = <span class=\"hljs-number\">3</span>.<span class=\"hljs-number\">5699</span>\n<span class=\"hljs-attribute\">xn</span> = x<span class=\"hljs-number\">0</span>\n<span class=\"hljs-attribute\">xk</span> = x<span class=\"hljs-number\">1</span>\n\n<span class=\"hljs-attribute\">accumulated</span> = ''\n\n<span class=\"hljs-comment\">#user = input(\"I N P U T: \")</span>\n<span class=\"hljs-comment\"># user = bytes.fromhex(user)</span>\n<span class=\"hljs-comment\"># if not user:</span>\n<span class=\"hljs-comment\">#     print('Non-hex byte entered!')</span>\n<span class=\"hljs-comment\">#     sys.exit()</span>\n\n\n<span class=\"hljs-attribute\">flag</span> = b'\\x<span class=\"hljs-number\">8</span>b*&#x3C;LH~\\xdc\\xc<span class=\"hljs-number\">4</span>\\xfc\\xad\\xff<span class=\"hljs-number\">9</span>\\xe<span class=\"hljs-number\">8</span>h\\x<span class=\"hljs-number\">8</span>d^\\xf<span class=\"hljs-number\">2</span>\\xc<span class=\"hljs-number\">3</span>\\xa<span class=\"hljs-number\">7</span>\\xc<span class=\"hljs-number\">9</span>&#x26;\\x<span class=\"hljs-number\">8</span>f \\xeaE_\\xb<span class=\"hljs-number\">0</span>T\\x<span class=\"hljs-number\">05</span>\\xe<span class=\"hljs-number\">5</span>\\xff\\x<span class=\"hljs-number\">9</span>cD\\x<span class=\"hljs-number\">9</span>e\\x<span class=\"hljs-number\">84</span>\\x<span class=\"hljs-number\">13</span>k\\x<span class=\"hljs-number\">0</span>f~\\xb<span class=\"hljs-number\">5</span>\\x<span class=\"hljs-number\">9</span>cUm\\x<span class=\"hljs-number\">08</span>\\\\'\n\n<span class=\"hljs-attribute\">for</span> flagchar in flag:\n    <span class=\"hljs-attribute\">xn</span> = ((r * xn) * (<span class=\"hljs-number\">1</span> - xn)) % x<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-attribute\">xn</span> = int(xn * <span class=\"hljs-number\">100</span>) % <span class=\"hljs-number\">255</span>\n\n    <span class=\"hljs-comment\">#xk = ((xk * r) * (1 - xk)) % x1</span>\n    <span class=\"hljs-comment\">#xk = (int(xk * 100)) % 255</span>\n\n    <span class=\"hljs-attribute\">flagbyte</span> = chr(xn ^ flagchar)\n    <span class=\"hljs-comment\">#userbyte = chr(xk ^ userchar)</span>\n\n    <span class=\"hljs-comment\"># if flagbyte != userbyte:</span>\n    <span class=\"hljs-comment\">#     print('Still in the woods')</span>\n    <span class=\"hljs-comment\">#     sys.exit()</span>\n    <span class=\"hljs-comment\"># else:</span>\n    <span class=\"hljs-attribute\">accumulated</span> += flagbyte\n\n<span class=\"hljs-attribute\">print</span>('Looking at it now, it <span class=\"hljs-literal\">all</span> seems so simple: {}'.format(accumulated))\n\n\n</code></pre>\n<p>Which revealed:</p>\n<p><code>Looking at it now, it all seems so simple: flag{th3_m0nst3rs_turned_0ut_2_be_ju5t_tr33s}</code></p>\n<p>For more writeups visit <a href=\"https://github.com/ChalmersCTF/Writeups\">https://github.com/ChalmersCTF/Writeups</a> and don't forget to check out my friend's and fellow team member's website <a href=\"https://www.nindoda.com/\">https://www.nindoda.com/</a>.</p>"}