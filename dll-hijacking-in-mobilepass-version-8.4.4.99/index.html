<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta content="utf-8" http-equiv=encoding><link rel=preload href=/fonts/vollkorn/Vollkorn-VariableFont_wght.ttf as=font type=font/ttf crossorigin><link rel=stylesheet href=/css/bootstrap-grid.min.css type=text/css><link rel=stylesheet href=/css/main.css type=text/css><meta name=apple-mobile-web-app-title content="dubell.io | DLL Hijacking in MobilePASS version 8.4.4.99"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=twitter:site content="@dubs3c"><meta name=twitter:creator content="@dubs3c"><meta property="og:title" content="dubell.io | DLL Hijacking in MobilePASS version 8.4.4.99"><meta name=twitter:title content="dubell.io | DLL Hijacking in MobilePASS version 8.4.4.99"><meta itemprop=name content="dubell.io | DLL Hijacking in MobilePASS version 8.4.4.99"><meta name=application-name content="dubell.io | DLL Hijacking in MobilePASS version 8.4.4.99"><meta property="og:site_name" content="dubell.io"><meta property="og:article:published_time" content=2024-08-09T00:00:00Z><meta property="article:published_time" content=2024-08-09T00:00:00Z><base href=https://dubell.io/dll-hijacking-in-mobilepass-version-8.4.4.99/><link rel=canonical href=https://dubell.io/dll-hijacking-in-mobilepass-version-8.4.4.99/ itemprop=url><meta name=url content="https://dubell.io/dll-hijacking-in-mobilepass-version-8.4.4.99/"><meta name=twitter:url content="https://dubell.io/dll-hijacking-in-mobilepass-version-8.4.4.99/"><meta property="og:url" content="https://dubell.io/dll-hijacking-in-mobilepass-version-8.4.4.99/"><meta property="og:article:author" content="Dubs3c"><meta property="article:author" content="Dubs3c"><meta name=author content="Dubs3c"><meta name=description content="DLL Hijacking in MobilePASS version 8.4.4.99"><meta itemprop=description content="DLL Hijacking in MobilePASS version 8.4.4.99"><meta property="og:description" content="DLL Hijacking in MobilePASS version 8.4.4.99"><meta name=twitter:description content="DLL Hijacking in MobilePASS version 8.4.4.99"><meta itemprop=image content="https://dubell.io/img/logo2.png"><meta property="og:image" content="https://dubell.io/img/logo2.png"><meta name=twitter:image content="https://dubell.io/img/logo2.png"><meta name=twitter:image:src content="https://dubell.io/img/logo2.png"><meta property="og:updated_time" content=2024-08-09T00:00:00Z><link rel=sitemap type=application/xml title=Sitemap href=https://dubell.io/sitemap.xml><title>dubell.io | DLL Hijacking in MobilePASS version 8.4.4.99</title></head><body><div class=container><div class=row><div class=col><h1 class=logo-title><a href=/>dubell.io</a></h1></div></div><div class=row><div class=col-lg-6><nav id=menu><ul><li><a href=/>/etc/motd</a></li><li><a href=/www/>/var/www</a></li><li><a href=/categories/advisories/>/home/advisories</a></li><li><a href="https://github.com/dubs3c?tab=repositories&q=&type=source&language=&sort=">/home/code</a></li><li><a href=/mnt/>/mnt</a></li><li><a href=/usr/>/usr</a></li></ul></nav></div></div><div class=row><article><h1>DLL Hijacking in MobilePASS version 8.4.4.99</h1><p><small><a href=/categories/advisories>Advisories</a> / August 9, 2024 â€¢ 1 min read</small><br><small><strong>Tags:</strong> <a href=/tags/windows class=tag>windows</a> <a href=/tags/exploit class=tag>exploit</a></small></p><div id=article_content><div class=row><div class=col-lg-6><p>During an engagement, I identified a DLL hijacking vulnerability in <a href="https://apps.microsoft.com/detail/9nblggh10pdq?hl=en-us&amp;gl=US">MobilePASS</a> for Windows, version 8.4.4.99. MobilePASS is a Two-factor authentication solution, which can run on Windows.</p><p>When MobilePASS is executed, it attempts to load <code>etoken.dll</code> from several locations, including the user&rsquo;s desktop folder and the <code>%APPDATA%</code> directory.</p><p><img src=process-monitor.png alt=process-monitor.png></p><p>This enables an attacker with local access to place a malicious <code>etoken.dll</code> in the directory where MobilePASS attempts to load it. As a result, the attacker can disguise their activity behind MobilePASS.</p><p>To demonstrate the vulnerability, a simple DLL program was created in C# that writes a debug string when MobilePASS is launched.</p><p><img src=DebugView.png alt=DebugView.png></p><p>DLL Hijacking has several sub-techniques. In this instance DLL Proxying was utilized, where the malicious DLL forwards calls to the real DLL. This keeps MobilePASS&rsquo;s functionality intact while still executing the malicious code.</p><p>The vulnerability assessment was limited to the specified version of MobilePASS, as newer versions were not available for testing. While this vulnerability did not directly enable privilege escalation, it could potentially serve as a persistence mechanism for an attacker.</p><p><strong>Disclosure Timeline:</strong></p><ul><li><strong>2024-07-21:</strong> The initial report is sent to CPL Security Response Team.</li><li><strong>2024-07-23:</strong> The CPL Team confirms that the issue is only present in version 8.4.4.x. Version 8.4.4.99 was released in 2016</li><li><strong>2024-07-30:</strong> No CVE will be requested due to the old version</li></ul><p><strong>Recommendations:</strong></p><p>Update to the latest version of MobilePASS. Regarding DLL hijacking, Microsoft has some good <a href=https://support.microsoft.com/en-us/topic/secure-loading-of-libraries-to-prevent-dll-preloading-attacks-d41303ec-0748-9211-f317-2edc819682e1>recommendations</a>.</p></div></div></div></article></div><div class=row><footer></footer></div></div><script src=/js/bootstrap.min.js async></script><script src=/js/main.js defer async></script></body></html>