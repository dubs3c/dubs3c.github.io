{"metadata":{"date":"Aug 8, 2015","title":"LogRhythm's Blackhat challenge - Write up","template":"post","slug":"logrhythms-blackhat-challenge-write-up","categories":["CTF"],"tags":["CTF"]},"content":"<p>For Blackhat 2015, LogRhythm Labs had a forensics contest for analyzing a .pcap file and finding the secret missile launch code. Find the password and enter the contest to win one of these:</p>\n<p><img src=\"../images/dji_phantom2.jpg\" alt=\"\"></p>\n<p>I really wanted to win this!</p>\n<h3>Analyzing the PCAP with WireShark</h3>\n<p>I downloaded the .pcap file and loaded it into wireshark. I begun by checking the Protocol Hierarchy under Statistics to get a view on the protocols used.</p>\n<p><img src=\"../images/Screen-Shot-2015-08-08-at-22-16-27.png\" alt=\"\"></p>\n<p>Hmm...telnet? I selected telnet as filter then followed the TCP stream, It was a star wars \"movie\" in ascii art:)</p>\n<p>Moving on from the Jedi mind tricks, I needed to find a secret missile launch code. I checked other TCP communications, a lot of encrypted data from google docs, I moved on to HTTP to see if I could find any interesting stuff there.</p>\n<p>I immediately found a POST request to 4shared.com which is a file sharing site. This meant someone probably uploaded something, could it be the launch codes?</p>\n<p><img src=\"../images/Screen-Shot-2015-08-08-at-22-28-19.png\" alt=\"\"></p>\n<p>Upon further investigation, I found a file called 1b.txt that was uploaded containing what seems to be assembly code.</p>\n<pre><code class=\"hljs language-basic\"><span class=\"hljs-symbol\">0 </span>   <span class=\"hljs-keyword\">INP</span> <span class=\"hljs-number\">14</span>\n<span class=\"hljs-symbol\">1 </span>   LDA <span class=\"hljs-number\">14</span>\n<span class=\"hljs-symbol\">2 </span>   LDB <span class=\"hljs-number\">15</span>\n<span class=\"hljs-symbol\">3 </span>   CMP\n<span class=\"hljs-symbol\">4 </span>   JLT <span class=\"hljs-number\">11</span>\n</code></pre>\n<p>I know nothing about assembly, the only thing I found that could help me was this: <a href=\"http://www.slidefinder.net/s/sec5_1assemblyprograms/sec521assemblyprograms/27400919\">http://www.slidefinder.net/s/sec5_1assemblyprograms/sec521assemblyprograms/27400919</a></p>\n<p>Looks like the same type of assembly I found. I probably spent more time on this than I should have.</p>\n<p>Moving on in my investigation, I wanted to see if there were any more POST requests. Using this simple filter <code>http.request.method eq POST</code> I found two more POST requests to pastebin.com.</p>\n<p>First request contained this string: <code>This is a test... hmmmmmm</code></p>\n<p>Second request contained the following:</p>\n<pre><code class=\"hljs\"></code></pre>\n<p>Binary code, perhaps this is what I am looking for.</p>\n<p>If we convert this to ASCII we get:</p>\n<pre><code class=\"hljs language-gcode\">Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NTM7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjU7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjM7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NzI7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjU7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NzQ7</span>Ji<span class=\"hljs-symbol\">N4</span>MjA<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NGM7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjE7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NzU7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NmU7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjM7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">Njg7</span>Ji<span class=\"hljs-symbol\">N4</span>MjA<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NDM7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NmY7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjQ7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjU7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-name\">M2</span>E<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>MjA<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>MzI<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">Njc7</span>Ji<span class=\"hljs-symbol\">N4</span>Mz<span class=\"hljs-name\">M7</span>Ji<span class=\"hljs-symbol\">N4</span>Mz<span class=\"hljs-name\">g7</span>Ji<span class=\"hljs-symbol\">N4</span>Mzk<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span><span class=\"hljs-symbol\">NjE7</span>Ji<span class=\"hljs-symbol\">N4</span>Mz<span class=\"hljs-name\">M7</span>Ji<span class=\"hljs-symbol\">N4</span>MzQ<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>MjE<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>MzA<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>MzI<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>Mzk<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>Mzc<span class=\"hljs-number\">7</span>Ji<span class=\"hljs-symbol\">N4</span>Mj<span class=\"hljs-name\">M7</span>\n</code></pre>\n<p>What do we have here? At first I thought this was some kind of cipher but after spending to much time on this I realized that it actually could be base64. So by appending a <code>=</code> at the end and converting, we get the following:</p>\n<p>HTML entities, lets convert  this as well and see what we get:</p>\n<p><code>Secret Launch Code: 2g389a34!0297#</code></p>\n<p>Success!</p>"}